[0m19:43:17.165987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd5111f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc188e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbd2ff80>]}


============================== 19:43:17.178683 | 5181db0e-ff7f-49ff-849f-4b4ffe7875f3 ==============================
[0m19:43:17.178683 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:43:17.179938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt init itsm_dbt_project', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:43:17.210171 [warn ] [MainThread]: [ConfigFolderDirectory]: Unable to parse logging event dictionary. Failed to parse dir field: expected string or bytes-like object, got 'PosixPath'.. Dictionary: {'dir': PosixPath('/root/.dbt')}
[0m19:43:17.211057 [info ] [MainThread]: Creating dbt configuration folder at 
[0m19:43:17.213053 [debug] [MainThread]: Starter project path: /usr/local/lib/python3.12/site-packages/dbt/include/starter_project
[0m19:43:17.224027 [info ] [MainThread]: 
Your new dbt project "itsm_dbt_project" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m19:43:17.224470 [info ] [MainThread]: Setting up your profile.
[0m19:47:55.263644 [info ] [MainThread]: Profile itsm_dbt_project written to /root/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m19:47:55.283390 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 278.16962, "process_in_blocks": "0", "process_kernel_time": 0.181433, "process_mem_max_rss": "108216", "process_out_blocks": "1484", "process_user_time": 1.333182}
[0m19:47:55.286902 [debug] [MainThread]: Command `dbt init` succeeded at 19:47:55.286001 after 278.18 seconds
[0m19:47:55.289408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd5f03b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffedba900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79d3a0>]}
[0m19:47:55.290631 [debug] [MainThread]: Flushing usage events
[0m19:47:56.837755 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:48:35.250528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb8bb080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcb89ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc37c080>]}


============================== 19:48:35.264397 | a2dd712a-ffb5-4407-bc2c-41ab69d8b269 ==============================
[0m19:48:35.264397 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:48:35.265569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': 'logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:48:35.295419 [info ] [MainThread]: dbt version: 1.9.0
[0m19:48:35.296012 [info ] [MainThread]: python version: 3.12.4
[0m19:48:35.296617 [info ] [MainThread]: python path: /usr/local/bin/python
[0m19:48:35.297145 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-x86_64-with-glibc2.31
[0m19:48:35.297639 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m19:48:35.298054 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m19:48:35.298512 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m19:48:35.298958 [info ] [MainThread]: Configuration:
[0m19:48:35.299331 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m19:48:35.299800 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m19:48:35.300174 [info ] [MainThread]: Required dependencies:
[0m19:48:35.300828 [debug] [MainThread]: Executing "git --help"
[0m19:48:35.321530 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:48:35.322284 [debug] [MainThread]: STDERR: "b''"
[0m19:48:35.322643 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:48:35.323051 [info ] [MainThread]: Connection test skipped since no profile was found
[0m19:48:35.323792 [info ] [MainThread]: [31m2 checks failed:[0m
[0m19:48:35.324279 [info ] [MainThread]: dbt looked for a profiles.yml file in /root/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m19:48:35.324678 [info ] [MainThread]: Project loading failed for the following reason:
 project path </usr/app/dbt_project.yml> not found

[0m19:48:35.327431 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.128837, "process_in_blocks": "0", "process_kernel_time": 0.159624, "process_mem_max_rss": "102488", "process_out_blocks": "1474", "process_user_time": 1.201223}
[0m19:48:35.328052 [debug] [MainThread]: Command `dbt debug` failed at 19:48:35.327928 after 0.13 seconds
[0m19:48:35.328639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc35be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc37f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc05d7f0>]}
[0m19:48:35.329046 [debug] [MainThread]: Flushing usage events
[0m19:48:36.709520 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:58:47.044941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbcf78f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb9f5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd4addc0>]}


============================== 19:58:47.058242 | 82a9b99a-f1e1-49e1-8693-a413d06f4088 ==============================
[0m19:58:47.058242 [info ] [MainThread]: Running with dbt=1.9.0
[0m19:58:47.059417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt init itsm_dbt_project', 'send_anonymous_usage_stats': 'True'}
[0m19:58:47.091329 [error] [MainThread]: Encountered an error:
'NoneType' object is not subscriptable
[0m19:58:47.093958 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/cli/main.py", line 477, in init
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/init.py", line 319, in run
    profile_name = self.get_profile_name_from_current_project()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/dbt/task/init.py", line 140, in get_profile_name_from_current_project
    return dbt_project["profile"]
           ~~~~~~~~~~~^^^^^^^^^^^
TypeError: 'NoneType' object is not subscriptable

[0m19:58:47.096162 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": false, "command_wall_clock_time": 0.105008624, "process_in_blocks": "176", "process_kernel_time": 0.170804, "process_mem_max_rss": "102608", "process_out_blocks": "1468", "process_user_time": 1.158673}
[0m19:58:47.097028 [debug] [MainThread]: Command `dbt init` failed at 19:58:47.096882 after 0.11 seconds
[0m19:58:47.097592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd5f0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb8f53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbb03800>]}
[0m19:58:47.098015 [debug] [MainThread]: Flushing usage events
[0m19:58:48.596270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:02:14.103591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbc6f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbacc3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbc6dee0>]}


============================== 20:02:14.117067 | ed850ab5-a3f3-4c10-bfb7-977df0f9cb94 ==============================
[0m20:02:14.117067 [info ] [MainThread]: Running with dbt=1.9.0
[0m20:02:14.118421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m20:02:14.146799 [info ] [MainThread]: dbt version: 1.9.0
[0m20:02:14.147680 [info ] [MainThread]: python version: 3.12.4
[0m20:02:14.148361 [info ] [MainThread]: python path: /usr/local/bin/python
[0m20:02:14.148852 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-x86_64-with-glibc2.31
[0m20:02:14.149391 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m20:02:14.149822 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m20:02:14.150195 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m20:02:14.226098 [info ] [MainThread]: Configuration:
[0m20:02:14.226664 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m20:02:14.227086 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:02:14.227546 [info ] [MainThread]: Required dependencies:
[0m20:02:14.228200 [debug] [MainThread]: Executing "git --help"
[0m20:02:14.248167 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:02:14.249144 [debug] [MainThread]: STDERR: "b''"
[0m20:02:14.249526 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:02:14.249952 [info ] [MainThread]: Connection test skipped since no profile was found
[0m20:02:14.250444 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:02:14.250859 [info ] [MainThread]: dbt looked for a profiles.yml file in /root/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m20:02:14.253481 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.20322429, "process_in_blocks": "0", "process_kernel_time": 0.131781, "process_mem_max_rss": "104208", "process_out_blocks": "1474", "process_user_time": 1.2679}
[0m20:02:14.254104 [debug] [MainThread]: Command `dbt debug` failed at 20:02:14.253967 after 0.21 seconds
[0m20:02:14.254708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbacc3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb96ae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7d4d40>]}
[0m20:02:14.255109 [debug] [MainThread]: Flushing usage events
[0m20:02:15.849685 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:06:39.672104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbc27350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbc272f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffbc257f0>]}


============================== 20:06:39.684850 | be87d320-ecfd-4de2-b077-722c62cdc119 ==============================
[0m20:06:39.684850 [info ] [MainThread]: Running with dbt=1.9.0
[0m20:06:39.686021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m20:06:39.714626 [info ] [MainThread]: dbt version: 1.9.0
[0m20:06:39.715204 [info ] [MainThread]: python version: 3.12.4
[0m20:06:39.715710 [info ] [MainThread]: python path: /usr/local/bin/python
[0m20:06:39.716203 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-x86_64-with-glibc2.31
[0m20:06:39.771150 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m20:06:39.771701 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m20:06:39.772222 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m20:06:39.772795 [info ] [MainThread]: adapter type: postgres
[0m20:06:39.773253 [info ] [MainThread]: adapter version: 1.9.0
[0m20:06:39.862726 [info ] [MainThread]: Configuration:
[0m20:06:39.863320 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:06:39.863862 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:06:39.864396 [info ] [MainThread]: Required dependencies:
[0m20:06:39.865301 [debug] [MainThread]: Executing "git --help"
[0m20:06:39.891408 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:06:39.892132 [debug] [MainThread]: STDERR: "b''"
[0m20:06:39.892530 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:06:39.893003 [info ] [MainThread]: Connection:
[0m20:06:39.893560 [info ] [MainThread]:   host: postgres
[0m20:06:39.893983 [info ] [MainThread]:   port: 5433
[0m20:06:39.894385 [info ] [MainThread]:   user: dbt_user
[0m20:06:39.894831 [info ] [MainThread]:   database: itsm_db
[0m20:06:39.895214 [info ] [MainThread]:   schema: public
[0m20:06:39.895642 [info ] [MainThread]:   connect_timeout: 10
[0m20:06:39.896255 [info ] [MainThread]:   role: None
[0m20:06:39.896841 [info ] [MainThread]:   search_path: None
[0m20:06:39.897210 [info ] [MainThread]:   keepalives_idle: 0
[0m20:06:39.897684 [info ] [MainThread]:   sslmode: None
[0m20:06:39.898064 [info ] [MainThread]:   sslcert: None
[0m20:06:39.898440 [info ] [MainThread]:   sslkey: None
[0m20:06:39.898796 [info ] [MainThread]:   sslrootcert: None
[0m20:06:39.899141 [info ] [MainThread]:   application_name: dbt
[0m20:06:39.899595 [info ] [MainThread]:   retries: 1
[0m20:06:39.900227 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:06:39.962270 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:06:39.995990 [debug] [MainThread]: Using postgres connection "debug"
[0m20:06:39.996589 [debug] [MainThread]: On debug: select 1 as id
[0m20:06:39.996973 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:06:40.050104 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: Name or service not known

[0m20:06:40.055245 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m20:06:40.055704 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m20:06:40.056080 [debug] [MainThread]: On debug: No close available on handle
[0m20:06:40.056469 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:06:40.056964 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:06:40.057523 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "postgres" to address: Name or service not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:06:40.061528 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.44619155, "process_in_blocks": "0", "process_kernel_time": 0.165893, "process_mem_max_rss": "115376", "process_out_blocks": "1502", "process_user_time": 1.425081}
[0m20:06:40.062302 [debug] [MainThread]: Command `dbt debug` failed at 20:06:40.062136 after 0.45 seconds
[0m20:06:40.062739 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:06:40.063345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffc268fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb68d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79f710>]}
[0m20:06:40.063889 [debug] [MainThread]: Flushing usage events
[0m20:06:41.568304 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:49:50.178674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd7bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41ea0>]}


============================== 06:49:50.190048 | 3034e512-24fd-41bc-bad1-0537ae910d76 ==============================
[0m06:49:50.190048 [info ] [MainThread]: Running with dbt=1.7.0
[0m06:49:50.190872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:49:50.191648 [info ] [MainThread]: dbt version: 1.7.0
[0m06:49:50.192006 [info ] [MainThread]: python version: 3.10.7
[0m06:49:50.192855 [info ] [MainThread]: python path: /usr/local/bin/python
[0m06:49:50.193258 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-x86_64-with-glibc2.31
[0m06:49:50.281574 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m06:49:50.282097 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m06:49:50.282567 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m06:49:50.283150 [info ] [MainThread]: adapter type: postgres
[0m06:49:50.283607 [info ] [MainThread]: adapter version: 1.7.0
[0m06:49:50.339213 [info ] [MainThread]: Configuration:
[0m06:49:50.339779 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m06:49:50.340312 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m06:49:50.340748 [info ] [MainThread]: Required dependencies:
[0m06:49:50.341410 [debug] [MainThread]: Executing "git --help"
[0m06:49:50.369097 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:49:50.369871 [debug] [MainThread]: STDERR: "b''"
[0m06:49:50.370217 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m06:49:50.370596 [info ] [MainThread]: Connection:
[0m06:49:50.371086 [info ] [MainThread]:   host: postgres
[0m06:49:50.371460 [info ] [MainThread]:   port: 5433
[0m06:49:50.371826 [info ] [MainThread]:   user: dbt_user
[0m06:49:50.372165 [info ] [MainThread]:   database: itsm_db
[0m06:49:50.372499 [info ] [MainThread]:   schema: public
[0m06:49:50.372859 [info ] [MainThread]:   connect_timeout: 10
[0m06:49:50.373204 [info ] [MainThread]:   role: None
[0m06:49:50.373560 [info ] [MainThread]:   search_path: None
[0m06:49:50.373847 [info ] [MainThread]:   keepalives_idle: 0
[0m06:49:50.374193 [info ] [MainThread]:   sslmode: None
[0m06:49:50.374561 [info ] [MainThread]:   sslcert: None
[0m06:49:50.374900 [info ] [MainThread]:   sslkey: None
[0m06:49:50.375256 [info ] [MainThread]:   sslrootcert: None
[0m06:49:50.375578 [info ] [MainThread]:   application_name: dbt
[0m06:49:50.376081 [info ] [MainThread]:   retries: 1
[0m06:49:50.376611 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m06:49:50.378310 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m06:49:50.378664 [debug] [MainThread]: Using postgres connection "debug"
[0m06:49:50.378928 [debug] [MainThread]: On debug: select 1 as id
[0m06:49:50.379158 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:49:50.390132 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgres" (172.19.0.2), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m06:49:50.391701 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m06:49:50.392022 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m06:49:50.392325 [debug] [MainThread]: On debug: No close available on handle
[0m06:49:50.392656 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m06:49:50.393096 [info ] [MainThread]: [31m1 check failed:[0m
[0m06:49:50.393701 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "postgres" (172.19.0.2), port 5433 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m06:49:50.396375 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.2645673, "process_user_time": 1.827906, "process_kernel_time": 0.122457, "process_mem_max_rss": "120864", "process_in_blocks": "90616", "process_out_blocks": "622", "command_success": false}
[0m06:49:50.397034 [debug] [MainThread]: Command `dbt debug` failed at 06:49:50.396872 after 0.27 seconds
[0m06:49:50.397360 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m06:49:50.397658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd7bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff924d120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff91ed180>]}
[0m06:49:50.398025 [debug] [MainThread]: Flushing usage events
[0m06:53:52.672433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd7ed70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41f30>]}


============================== 06:53:52.682438 | f8275358-c065-4ec1-87f3-6185ebf241a6 ==============================
[0m06:53:52.682438 [info ] [MainThread]: Running with dbt=1.7.0
[0m06:53:52.683295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:53:52.683910 [info ] [MainThread]: dbt version: 1.7.0
[0m06:53:52.684417 [info ] [MainThread]: python version: 3.10.7
[0m06:53:52.685023 [info ] [MainThread]: python path: /usr/local/bin/python
[0m06:53:52.685573 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-x86_64-with-glibc2.31
[0m06:53:52.758083 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m06:53:52.758636 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m06:53:52.759107 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m06:53:52.759692 [info ] [MainThread]: adapter type: postgres
[0m06:53:52.760028 [info ] [MainThread]: adapter version: 1.7.0
[0m06:53:52.816167 [info ] [MainThread]: Configuration:
[0m06:53:52.816736 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m06:53:52.817195 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m06:53:52.817673 [info ] [MainThread]: Required dependencies:
[0m06:53:52.818505 [debug] [MainThread]: Executing "git --help"
[0m06:53:52.837815 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:53:52.838561 [debug] [MainThread]: STDERR: "b''"
[0m06:53:52.838905 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m06:53:52.839300 [info ] [MainThread]: Connection:
[0m06:53:52.839790 [info ] [MainThread]:   host: postgres
[0m06:53:52.840159 [info ] [MainThread]:   port: 5432
[0m06:53:52.840643 [info ] [MainThread]:   user: dbt_user
[0m06:53:52.841003 [info ] [MainThread]:   database: itsm_db
[0m06:53:52.841382 [info ] [MainThread]:   schema: public
[0m06:53:52.841735 [info ] [MainThread]:   connect_timeout: 10
[0m06:53:52.842114 [info ] [MainThread]:   role: None
[0m06:53:52.842498 [info ] [MainThread]:   search_path: None
[0m06:53:52.842836 [info ] [MainThread]:   keepalives_idle: 0
[0m06:53:52.843182 [info ] [MainThread]:   sslmode: None
[0m06:53:52.843582 [info ] [MainThread]:   sslcert: None
[0m06:53:52.843919 [info ] [MainThread]:   sslkey: None
[0m06:53:52.844269 [info ] [MainThread]:   sslrootcert: None
[0m06:53:52.844731 [info ] [MainThread]:   application_name: dbt
[0m06:53:52.845056 [info ] [MainThread]:   retries: 1
[0m06:53:52.845585 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m06:53:52.847538 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m06:53:52.847909 [debug] [MainThread]: Using postgres connection "debug"
[0m06:53:52.848195 [debug] [MainThread]: On debug: select 1 as id
[0m06:53:52.848496 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:53:52.908163 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m06:53:52.909417 [debug] [MainThread]: On debug: Close
[0m06:53:52.909868 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m06:53:52.910260 [info ] [MainThread]: [32mAll checks passed![0m
[0m06:53:52.912779 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.28581983, "process_user_time": 1.84048, "process_kernel_time": 0.109147, "process_mem_max_rss": "125632", "process_in_blocks": "3296", "process_out_blocks": "620"}
[0m06:53:52.913472 [debug] [MainThread]: Command `dbt debug` succeeded at 06:53:52.913308 after 0.29 seconds
[0m06:53:52.913805 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m06:53:52.914253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd7ed70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb459600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffa9f4550>]}
[0m06:53:52.914892 [debug] [MainThread]: Flushing usage events
[0m06:54:04.085073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd1b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41e40>]}


============================== 06:54:04.092548 | 8551f34f-63b3-45a4-bdc5-3bcd01ab5c60 ==============================
[0m06:54:04.092548 [info ] [MainThread]: Running with dbt=1.7.0
[0m06:54:04.093575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:54:04.228907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8551f34f-63b3-45a4-bdc5-3bcd01ab5c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41f90>]}
[0m06:54:04.293772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8551f34f-63b3-45a4-bdc5-3bcd01ab5c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8fc4790>]}
[0m06:54:04.294521 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m06:54:04.303328 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m06:54:04.304233 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:54:04.304672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8551f34f-63b3-45a4-bdc5-3bcd01ab5c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8fc4a30>]}
[0m06:54:04.865613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8551f34f-63b3-45a4-bdc5-3bcd01ab5c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8f799f0>]}
[0m06:54:04.880318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8551f34f-63b3-45a4-bdc5-3bcd01ab5c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8f6e8c0>]}
[0m06:54:04.880757 [info ] [MainThread]: Found 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m06:54:04.881162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8551f34f-63b3-45a4-bdc5-3bcd01ab5c60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8f6ef80>]}
[0m06:54:04.882456 [info ] [MainThread]: 
[0m06:54:04.882967 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:54:04.884042 [debug] [MainThread]: Command end result
[0m06:54:04.891029 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.85337555, "process_user_time": 2.400094, "process_kernel_time": 0.108822, "process_mem_max_rss": "127036", "process_in_blocks": "1736", "process_out_blocks": "2205"}
[0m06:54:04.891673 [debug] [MainThread]: Command `dbt run` succeeded at 06:54:04.891503 after 0.85 seconds
[0m06:54:04.892119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd1b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8fc5690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8fc4790>]}
[0m06:54:04.892457 [debug] [MainThread]: Flushing usage events
[0m07:12:34.635939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd1b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41e70>]}


============================== 07:12:34.643433 | 6d354600-6b76-4016-9b8e-71fbd83e0ff2 ==============================
[0m07:12:34.643433 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:12:34.644305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select tickets_analysis', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:12:34.774170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d354600-6b76-4016-9b8e-71fbd83e0ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41fc0>]}
[0m07:12:34.839701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d354600-6b76-4016-9b8e-71fbd83e0ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8fc94e0>]}
[0m07:12:34.840310 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:12:34.849431 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m07:12:34.872454 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m07:12:34.872927 [debug] [MainThread]: Partial parsing: added file: itsm_dbt_project://models/tickets_analysis.sql
[0m07:12:34.998021 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.itsm_dbt_project.tickets_analysis' (models/tickets_analysis.sql) depends on a source named 'public.tickets_raw' which was not found
[0m07:12:35.000300 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.41137928, "process_user_time": 1.934792, "process_kernel_time": 0.10721, "process_mem_max_rss": "126016", "process_in_blocks": "416", "process_out_blocks": "4", "command_success": false}
[0m07:12:35.001380 [debug] [MainThread]: Command `dbt run` failed at 07:12:35.001207 after 0.41 seconds
[0m07:12:35.001969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd1b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8e14a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff928e470>]}
[0m07:12:35.002343 [debug] [MainThread]: Flushing usage events
[0m07:14:21.349068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd1b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41e70>]}


============================== 07:14:21.356735 | faba8479-c703-4653-a757-f03d171e74bd ==============================
[0m07:14:21.356735 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:14:21.357594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tickets_analysis', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:14:21.486023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'faba8479-c703-4653-a757-f03d171e74bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41fc0>]}
[0m07:14:21.549678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'faba8479-c703-4653-a757-f03d171e74bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8fc94e0>]}
[0m07:14:21.550279 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:14:21.559376 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m07:14:21.582313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m07:14:21.582874 [debug] [MainThread]: Partial parsing: added file: itsm_dbt_project://models/schema.yml
[0m07:14:21.583239 [debug] [MainThread]: Partial parsing: added file: itsm_dbt_project://models/tickets_analysis.sql
[0m07:14:21.773721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'faba8479-c703-4653-a757-f03d171e74bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7d040d0>]}
[0m07:14:21.791435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'faba8479-c703-4653-a757-f03d171e74bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8f47d30>]}
[0m07:14:21.791953 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:14:21.792396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'faba8479-c703-4653-a757-f03d171e74bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8f47e80>]}
[0m07:14:21.793767 [info ] [MainThread]: 
[0m07:14:21.794768 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:14:21.796817 [debug] [ThreadPool]: Acquiring new postgres connection 'list_itsm_db'
[0m07:14:21.807239 [debug] [ThreadPool]: Using postgres connection "list_itsm_db"
[0m07:14:21.807750 [debug] [ThreadPool]: On list_itsm_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "list_itsm_db"} */

    select distinct nspname from pg_namespace
  
[0m07:14:21.808070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:14:21.867888 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m07:14:21.869618 [debug] [ThreadPool]: On list_itsm_db: Close
[0m07:14:21.872305 [debug] [ThreadPool]: Acquiring new postgres connection 'list_itsm_db_public'
[0m07:14:21.877180 [debug] [ThreadPool]: Using postgres connection "list_itsm_db_public"
[0m07:14:21.877555 [debug] [ThreadPool]: On list_itsm_db_public: BEGIN
[0m07:14:21.877834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:14:21.885256 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:14:21.885683 [debug] [ThreadPool]: Using postgres connection "list_itsm_db_public"
[0m07:14:21.886019 [debug] [ThreadPool]: On list_itsm_db_public: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "list_itsm_db_public"} */
select
      'itsm_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'itsm_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'itsm_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:14:21.892174 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m07:14:21.893266 [debug] [ThreadPool]: On list_itsm_db_public: ROLLBACK
[0m07:14:21.893666 [debug] [ThreadPool]: On list_itsm_db_public: Close
[0m07:14:21.897793 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:21.898134 [debug] [MainThread]: On master: BEGIN
[0m07:14:21.898400 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:14:21.904341 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:14:21.904633 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:21.904996 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:14:21.909486 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m07:14:21.910369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'faba8479-c703-4653-a757-f03d171e74bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7be3760>]}
[0m07:14:21.910741 [debug] [MainThread]: On master: ROLLBACK
[0m07:14:21.911015 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:21.911297 [debug] [MainThread]: On master: BEGIN
[0m07:14:21.911669 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:14:21.911925 [debug] [MainThread]: On master: COMMIT
[0m07:14:21.912149 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:21.912390 [debug] [MainThread]: On master: COMMIT
[0m07:14:21.912649 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:14:21.912921 [debug] [MainThread]: On master: Close
[0m07:14:21.914128 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:14:21.914481 [info ] [MainThread]: 
[0m07:14:21.923923 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.tickets_analysis
[0m07:14:21.924460 [info ] [Thread-1 (]: 1 of 1 START sql table model public.tickets_analysis ........................... [RUN]
[0m07:14:21.925253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_itsm_db_public, now model.itsm_dbt_project.tickets_analysis)
[0m07:14:21.925645 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.tickets_analysis
[0m07:14:21.957142 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.tickets_analysis"
[0m07:14:21.959008 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.tickets_analysis (compile): 07:14:21.925877 => 07:14:21.958808
[0m07:14:21.959381 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.tickets_analysis
[0m07:14:21.989000 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.tickets_analysis"
[0m07:14:21.990545 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:14:21.990878 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: BEGIN
[0m07:14:21.991196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:14:21.997618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:14:21.997993 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:14:21.998344 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */

  
    

  create  table "itsm_db"."public"."tickets_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH cleaned AS (
    SELECT DISTINCT
        ticket_id,
        category,
        sub_category,
        priority,
        status,
        assigned_group,
        technician,
        COALESCE(resolution_time_hrs, EXTRACT(EPOCH FROM (resolved_date - created_date))/3600) AS resolution_time_hrs,
        created_date::timestamp AS created_date,
        resolved_date::timestamp AS resolved_date,
        customer_impact
    FROM "itsm_db"."public"."tickets_raw"
    WHERE ticket_id IS NOT NULL
)
SELECT
    *,
    EXTRACT(YEAR FROM created_date) AS created_year,
    EXTRACT(MONTH FROM created_date) AS created_month,
    EXTRACT(DAY FROM created_date) AS created_day,
    CASE WHEN status ILIKE 'closed' OR resolved_date IS NOT NULL THEN 1 ELSE 0 END AS is_closed
FROM cleaned;
  );
  
[0m07:14:21.999229 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 36: FROM cleaned;
                     ^

[0m07:14:21.999604 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: ROLLBACK
[0m07:14:22.000131 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.tickets_analysis (execute): 07:14:21.959602 => 07:14:21.999953
[0m07:14:22.000572 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: Close
[0m07:14:22.005610 [debug] [Thread-1 (]: Database Error in model tickets_analysis (models/tickets_analysis.sql)
  syntax error at or near ";"
  LINE 36: FROM cleaned;
                       ^
  compiled Code at target/run/itsm_dbt_project/models/tickets_analysis.sql
[0m07:14:22.006047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'faba8479-c703-4653-a757-f03d171e74bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff90deb00>]}
[0m07:14:22.006910 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.tickets_analysis .................. [[31mERROR[0m in 0.08s]
[0m07:14:22.007612 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.tickets_analysis
[0m07:14:22.009399 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:22.009689 [debug] [MainThread]: On master: BEGIN
[0m07:14:22.009924 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:14:22.016367 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:14:22.016732 [debug] [MainThread]: On master: COMMIT
[0m07:14:22.017054 [debug] [MainThread]: Using postgres connection "master"
[0m07:14:22.017333 [debug] [MainThread]: On master: COMMIT
[0m07:14:22.017669 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:14:22.017960 [debug] [MainThread]: On master: Close
[0m07:14:22.019259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:14:22.019604 [debug] [MainThread]: Connection 'list_itsm_db' was properly closed.
[0m07:14:22.019854 [debug] [MainThread]: Connection 'model.itsm_dbt_project.tickets_analysis' was properly closed.
[0m07:14:22.020315 [info ] [MainThread]: 
[0m07:14:22.020733 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m07:14:22.021496 [debug] [MainThread]: Command end result
[0m07:14:22.027679 [info ] [MainThread]: 
[0m07:14:22.028033 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:14:22.028360 [info ] [MainThread]: 
[0m07:14:22.028898 [error] [MainThread]:   Database Error in model tickets_analysis (models/tickets_analysis.sql)
  syntax error at or near ";"
  LINE 36: FROM cleaned;
                       ^
  compiled Code at target/run/itsm_dbt_project/models/tickets_analysis.sql
[0m07:14:22.029480 [info ] [MainThread]: 
[0m07:14:22.030066 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:14:22.031308 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7296413, "process_user_time": 2.188127, "process_kernel_time": 0.137321, "process_mem_max_rss": "140068", "process_in_blocks": "504", "process_out_blocks": "2317", "command_success": false}
[0m07:14:22.031833 [debug] [MainThread]: Command `dbt run` failed at 07:14:22.031721 after 0.73 seconds
[0m07:14:22.032182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd1b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8dcb730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c1a080>]}
[0m07:14:22.032544 [debug] [MainThread]: Flushing usage events
[0m07:21:16.990970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd1b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41e70>]}


============================== 07:21:16.998496 | 32535e1d-ed35-43ba-89f9-6110e9497724 ==============================
[0m07:21:16.998496 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:21:16.999209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select tickets_analysis', 'send_anonymous_usage_stats': 'True'}
[0m07:21:17.133030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32535e1d-ed35-43ba-89f9-6110e9497724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41fc0>]}
[0m07:21:17.199245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32535e1d-ed35-43ba-89f9-6110e9497724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8fc94e0>]}
[0m07:21:17.199977 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:21:17.209169 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m07:21:17.231967 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:21:17.232544 [debug] [MainThread]: Partial parsing: updated file: itsm_dbt_project://models/tickets_analysis.sql
[0m07:21:17.367683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32535e1d-ed35-43ba-89f9-6110e9497724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7ce0af0>]}
[0m07:21:17.381793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32535e1d-ed35-43ba-89f9-6110e9497724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8ead9f0>]}
[0m07:21:17.382237 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:21:17.382651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32535e1d-ed35-43ba-89f9-6110e9497724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8eadc60>]}
[0m07:21:17.383967 [info ] [MainThread]: 
[0m07:21:17.385435 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:21:17.387441 [debug] [ThreadPool]: Acquiring new postgres connection 'list_itsm_db'
[0m07:21:17.396032 [debug] [ThreadPool]: Using postgres connection "list_itsm_db"
[0m07:21:17.396406 [debug] [ThreadPool]: On list_itsm_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "list_itsm_db"} */

    select distinct nspname from pg_namespace
  
[0m07:21:17.396735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:21:17.445351 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m07:21:17.446913 [debug] [ThreadPool]: On list_itsm_db: Close
[0m07:21:17.449492 [debug] [ThreadPool]: Acquiring new postgres connection 'list_itsm_db_public'
[0m07:21:17.454190 [debug] [ThreadPool]: Using postgres connection "list_itsm_db_public"
[0m07:21:17.454522 [debug] [ThreadPool]: On list_itsm_db_public: BEGIN
[0m07:21:17.454814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:21:17.462127 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:21:17.462443 [debug] [ThreadPool]: Using postgres connection "list_itsm_db_public"
[0m07:21:17.462760 [debug] [ThreadPool]: On list_itsm_db_public: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "list_itsm_db_public"} */
select
      'itsm_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'itsm_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'itsm_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:21:17.472802 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m07:21:17.473926 [debug] [ThreadPool]: On list_itsm_db_public: ROLLBACK
[0m07:21:17.474293 [debug] [ThreadPool]: On list_itsm_db_public: Close
[0m07:21:17.479027 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:17.479342 [debug] [MainThread]: On master: BEGIN
[0m07:21:17.479637 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:21:17.485585 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:21:17.485899 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:17.486265 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:21:17.488887 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m07:21:17.489757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32535e1d-ed35-43ba-89f9-6110e9497724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cd9f00>]}
[0m07:21:17.490118 [debug] [MainThread]: On master: ROLLBACK
[0m07:21:17.490418 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:17.490664 [debug] [MainThread]: On master: BEGIN
[0m07:21:17.490967 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:21:17.491230 [debug] [MainThread]: On master: COMMIT
[0m07:21:17.491498 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:17.491731 [debug] [MainThread]: On master: COMMIT
[0m07:21:17.491983 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:21:17.492241 [debug] [MainThread]: On master: Close
[0m07:21:17.493407 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:21:17.493824 [info ] [MainThread]: 
[0m07:21:17.496596 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.tickets_analysis
[0m07:21:17.497091 [info ] [Thread-1 (]: 1 of 1 START sql table model public.tickets_analysis ........................... [RUN]
[0m07:21:17.497842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_itsm_db_public, now model.itsm_dbt_project.tickets_analysis)
[0m07:21:17.498165 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.tickets_analysis
[0m07:21:17.505357 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.tickets_analysis"
[0m07:21:17.506389 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.tickets_analysis (compile): 07:21:17.498395 => 07:21:17.506176
[0m07:21:17.506728 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.tickets_analysis
[0m07:21:17.536643 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.tickets_analysis"
[0m07:21:17.537654 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:21:17.538012 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: BEGIN
[0m07:21:17.538351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:17.544834 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:21:17.545222 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:21:17.545621 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */

  
    

  create  table "itsm_db"."public"."tickets_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH cleaned AS (
    SELECT DISTINCT
        ticket_id,
        category,
        sub_category,
        priority,
        status,
        assigned_group,
        technician,
        COALESCE(resolution_time_hrs, EXTRACT(EPOCH FROM (resolved_date - created_date))/3600) AS resolution_time_hrs,
        created_date::timestamp AS created_date,
        resolved_date::timestamp AS resolved_date,
        customer_impact
    FROM "itsm_db"."public"."tickets_raw"
    WHERE ticket_id IS NOT NULL
)
SELECT
    *,
    EXTRACT(YEAR FROM created_date) AS created_year,
    EXTRACT(MONTH FROM created_date) AS created_month,
    EXTRACT(DAY FROM created_date) AS created_day,
    CASE WHEN status ILIKE 'closed' OR resolved_date IS NOT NULL THEN 1 ELSE 0 END AS is_closed
FROM cleaned
  );
  
[0m07:21:17.546617 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "ticket_id" does not exist
LINE 16:         ticket_id,
                 ^

[0m07:21:17.546959 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: ROLLBACK
[0m07:21:17.547468 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.tickets_analysis (execute): 07:21:17.506955 => 07:21:17.547277
[0m07:21:17.547765 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: Close
[0m07:21:17.549771 [debug] [Thread-1 (]: Database Error in model tickets_analysis (models/tickets_analysis.sql)
  column "ticket_id" does not exist
  LINE 16:         ticket_id,
                   ^
  compiled Code at target/run/itsm_dbt_project/models/tickets_analysis.sql
[0m07:21:17.550403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32535e1d-ed35-43ba-89f9-6110e9497724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7d0f910>]}
[0m07:21:17.551431 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model public.tickets_analysis .................. [[31mERROR[0m in 0.05s]
[0m07:21:17.552170 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.tickets_analysis
[0m07:21:17.554344 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:17.554732 [debug] [MainThread]: On master: BEGIN
[0m07:21:17.555028 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:21:17.561478 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:21:17.561802 [debug] [MainThread]: On master: COMMIT
[0m07:21:17.562096 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:17.562361 [debug] [MainThread]: On master: COMMIT
[0m07:21:17.562718 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:21:17.562980 [debug] [MainThread]: On master: Close
[0m07:21:17.564231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:21:17.564527 [debug] [MainThread]: Connection 'list_itsm_db' was properly closed.
[0m07:21:17.564776 [debug] [MainThread]: Connection 'model.itsm_dbt_project.tickets_analysis' was properly closed.
[0m07:21:17.565188 [info ] [MainThread]: 
[0m07:21:17.565571 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m07:21:17.566315 [debug] [MainThread]: Command end result
[0m07:21:17.572888 [info ] [MainThread]: 
[0m07:21:17.573340 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:21:17.573797 [info ] [MainThread]: 
[0m07:21:17.574196 [error] [MainThread]:   Database Error in model tickets_analysis (models/tickets_analysis.sql)
  column "ticket_id" does not exist
  LINE 16:         ticket_id,
                   ^
  compiled Code at target/run/itsm_dbt_project/models/tickets_analysis.sql
[0m07:21:17.574610 [info ] [MainThread]: 
[0m07:21:17.575114 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:21:17.576294 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.63267314, "process_user_time": 2.08894, "process_kernel_time": 0.138796, "process_mem_max_rss": "138636", "process_out_blocks": "2261", "command_success": false, "process_in_blocks": "0"}
[0m07:21:17.576867 [debug] [MainThread]: Command `dbt run` failed at 07:21:17.576762 after 0.63 seconds
[0m07:21:17.577204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd1b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8fc94e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7d2aaa0>]}
[0m07:21:17.577509 [debug] [MainThread]: Flushing usage events
[0m07:23:22.091174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd1b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41e10>]}


============================== 07:23:22.098892 | ac8b592e-7f35-4208-917c-5b516db7a7f0 ==============================
[0m07:23:22.098892 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:23:22.099811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select tickets_analysis', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:23:22.232036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac8b592e-7f35-4208-917c-5b516db7a7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41f60>]}
[0m07:23:22.297218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac8b592e-7f35-4208-917c-5b516db7a7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8fcab00>]}
[0m07:23:22.297890 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:23:22.307300 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m07:23:22.333301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:23:22.333841 [debug] [MainThread]: Partial parsing: updated file: itsm_dbt_project://models/tickets_analysis.sql
[0m07:23:22.466745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac8b592e-7f35-4208-917c-5b516db7a7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7ce4a90>]}
[0m07:23:22.481211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac8b592e-7f35-4208-917c-5b516db7a7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8ead990>]}
[0m07:23:22.481608 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:23:22.481988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac8b592e-7f35-4208-917c-5b516db7a7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8eadbd0>]}
[0m07:23:22.483196 [info ] [MainThread]: 
[0m07:23:22.484357 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:23:22.486366 [debug] [ThreadPool]: Acquiring new postgres connection 'list_itsm_db'
[0m07:23:22.495315 [debug] [ThreadPool]: Using postgres connection "list_itsm_db"
[0m07:23:22.495712 [debug] [ThreadPool]: On list_itsm_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "list_itsm_db"} */

    select distinct nspname from pg_namespace
  
[0m07:23:22.496054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:23:22.546269 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m07:23:22.548108 [debug] [ThreadPool]: On list_itsm_db: Close
[0m07:23:22.550659 [debug] [ThreadPool]: Acquiring new postgres connection 'list_itsm_db_public'
[0m07:23:22.555667 [debug] [ThreadPool]: Using postgres connection "list_itsm_db_public"
[0m07:23:22.556020 [debug] [ThreadPool]: On list_itsm_db_public: BEGIN
[0m07:23:22.556302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:23:22.563623 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:23:22.564038 [debug] [ThreadPool]: Using postgres connection "list_itsm_db_public"
[0m07:23:22.564378 [debug] [ThreadPool]: On list_itsm_db_public: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "list_itsm_db_public"} */
select
      'itsm_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'itsm_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'itsm_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:23:22.568133 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m07:23:22.569377 [debug] [ThreadPool]: On list_itsm_db_public: ROLLBACK
[0m07:23:22.569839 [debug] [ThreadPool]: On list_itsm_db_public: Close
[0m07:23:22.574810 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:22.575167 [debug] [MainThread]: On master: BEGIN
[0m07:23:22.575425 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:23:22.581702 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:23:22.582011 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:22.582419 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:23:22.585220 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m07:23:22.586096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac8b592e-7f35-4208-917c-5b516db7a7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cddea0>]}
[0m07:23:22.586541 [debug] [MainThread]: On master: ROLLBACK
[0m07:23:22.586848 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:22.587108 [debug] [MainThread]: On master: BEGIN
[0m07:23:22.587469 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:23:22.587727 [debug] [MainThread]: On master: COMMIT
[0m07:23:22.587994 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:22.588284 [debug] [MainThread]: On master: COMMIT
[0m07:23:22.588575 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:23:22.588859 [debug] [MainThread]: On master: Close
[0m07:23:22.589975 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:23:22.590369 [info ] [MainThread]: 
[0m07:23:22.593401 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.tickets_analysis
[0m07:23:22.593948 [info ] [Thread-1 (]: 1 of 1 START sql table model public.tickets_analysis ........................... [RUN]
[0m07:23:22.594763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_itsm_db_public, now model.itsm_dbt_project.tickets_analysis)
[0m07:23:22.595147 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.tickets_analysis
[0m07:23:22.602055 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.tickets_analysis"
[0m07:23:22.603792 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.tickets_analysis (compile): 07:23:22.595382 => 07:23:22.603584
[0m07:23:22.604154 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.tickets_analysis
[0m07:23:22.634061 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.tickets_analysis"
[0m07:23:22.635223 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:23:22.635614 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: BEGIN
[0m07:23:22.635923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:23:22.642358 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:23:22.642759 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:23:22.643098 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */

  
    

  create  table "itsm_db"."public"."tickets_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH cleaned AS (
    SELECT DISTINCT
        inc_number AS ticket_id,
        inc_category AS category,
        inc_short_description AS sub_category,
        inc_priority AS priority,
        inc_state AS status,
        inc_assignment_group AS assigned_group,
        inc_assigned_to AS technician,
        NULL::float AS resolution_time_hrs,
        inc_sys_created_on::timestamp AS created_date,
        inc_resolved_at::timestamp AS resolved_date,
        NULL::text AS customer_impact
    FROM "itsm_db"."public"."tickets_raw"
    WHERE inc_number IS NOT NULL
)
SELECT
    *,
    EXTRACT(YEAR FROM created_date) AS created_year,
    EXTRACT(MONTH FROM created_date) AS created_month,
    EXTRACT(DAY FROM created_date) AS created_day,
    CASE WHEN status ILIKE 'closed' OR resolved_date IS NOT NULL THEN 1 ELSE 0 END AS is_closed
FROM cleaned
  );
  
[0m07:23:22.673537 [debug] [Thread-1 (]: SQL status: SELECT 4918 in 0.0 seconds
[0m07:23:22.678602 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:23:22.678975 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */
alter table "itsm_db"."public"."tickets_analysis__dbt_tmp" rename to "tickets_analysis"
[0m07:23:22.680362 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:23:22.693522 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: COMMIT
[0m07:23:22.693991 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:23:22.694500 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: COMMIT
[0m07:23:22.698849 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:23:22.703729 [debug] [Thread-1 (]: Applying DROP to: "itsm_db"."public"."tickets_analysis__dbt_backup"
[0m07:23:22.707151 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:23:22.707489 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */
drop table if exists "itsm_db"."public"."tickets_analysis__dbt_backup" cascade
[0m07:23:22.707889 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m07:23:22.709107 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.tickets_analysis (execute): 07:23:22.604387 => 07:23:22.708935
[0m07:23:22.709467 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: Close
[0m07:23:22.710237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac8b592e-7f35-4208-917c-5b516db7a7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7d7bc40>]}
[0m07:23:22.711265 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.tickets_analysis ...................... [[32mSELECT 4918[0m in 0.12s]
[0m07:23:22.712080 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.tickets_analysis
[0m07:23:22.714114 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:22.714498 [debug] [MainThread]: On master: BEGIN
[0m07:23:22.714804 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:23:22.722081 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:23:22.722450 [debug] [MainThread]: On master: COMMIT
[0m07:23:22.722724 [debug] [MainThread]: Using postgres connection "master"
[0m07:23:22.722975 [debug] [MainThread]: On master: COMMIT
[0m07:23:22.723246 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:23:22.723503 [debug] [MainThread]: On master: Close
[0m07:23:22.724049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:23:22.725195 [debug] [MainThread]: Connection 'list_itsm_db' was properly closed.
[0m07:23:22.725612 [debug] [MainThread]: Connection 'model.itsm_dbt_project.tickets_analysis' was properly closed.
[0m07:23:22.726126 [info ] [MainThread]: 
[0m07:23:22.726569 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m07:23:22.727357 [debug] [MainThread]: Command end result
[0m07:23:22.733510 [info ] [MainThread]: 
[0m07:23:22.733916 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:23:22.734263 [info ] [MainThread]: 
[0m07:23:22.734801 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:23:22.736321 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6945176, "process_user_time": 2.107131, "process_kernel_time": 0.158687, "process_mem_max_rss": "138388", "process_out_blocks": "2264", "process_in_blocks": "0"}
[0m07:23:22.736949 [debug] [MainThread]: Command `dbt run` succeeded at 07:23:22.736843 after 0.70 seconds
[0m07:23:22.737274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd1b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cddea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8fc8d00>]}
[0m07:23:22.737596 [debug] [MainThread]: Flushing usage events
[0m07:30:55.971853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd1b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41e40>]}


============================== 07:30:55.982181 | d58cc040-97b6-4156-b0c4-9ed9877ab70d ==============================
[0m07:30:55.982181 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:30:55.983349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:30:56.124218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd58cc040-97b6-4156-b0c4-9ed9877ab70d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41f90>]}
[0m07:30:56.195445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd58cc040-97b6-4156-b0c4-9ed9877ab70d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8fc4790>]}
[0m07:30:56.196415 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:30:56.206625 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m07:30:56.234753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m07:30:56.235434 [debug] [MainThread]: Partial parsing: added file: itsm_dbt_project://models/models/monthly_ticket_summary.sql
[0m07:30:56.235850 [debug] [MainThread]: Partial parsing: added file: itsm_dbt_project://models/models/closure_rate_by_group.sql
[0m07:30:56.236199 [debug] [MainThread]: Partial parsing: added file: itsm_dbt_project://models/models/avg_resolution_by_cat_priority.sql
[0m07:30:56.381310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd58cc040-97b6-4156-b0c4-9ed9877ab70d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7ced900>]}
[0m07:30:56.395937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd58cc040-97b6-4156-b0c4-9ed9877ab70d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8f4f760>]}
[0m07:30:56.396343 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:30:56.396771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd58cc040-97b6-4156-b0c4-9ed9877ab70d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8f4f6a0>]}
[0m07:30:56.398333 [info ] [MainThread]: 
[0m07:30:56.399707 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:30:56.402183 [debug] [ThreadPool]: Acquiring new postgres connection 'list_itsm_db'
[0m07:30:56.411508 [debug] [ThreadPool]: Using postgres connection "list_itsm_db"
[0m07:30:56.411964 [debug] [ThreadPool]: On list_itsm_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "list_itsm_db"} */

    select distinct nspname from pg_namespace
  
[0m07:30:56.412307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:56.462516 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m07:30:56.464062 [debug] [ThreadPool]: On list_itsm_db: Close
[0m07:30:56.466745 [debug] [ThreadPool]: Acquiring new postgres connection 'list_itsm_db_public'
[0m07:30:56.471540 [debug] [ThreadPool]: Using postgres connection "list_itsm_db_public"
[0m07:30:56.471885 [debug] [ThreadPool]: On list_itsm_db_public: BEGIN
[0m07:30:56.472157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:56.480088 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:30:56.480431 [debug] [ThreadPool]: Using postgres connection "list_itsm_db_public"
[0m07:30:56.480752 [debug] [ThreadPool]: On list_itsm_db_public: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "list_itsm_db_public"} */
select
      'itsm_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'itsm_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'itsm_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:30:56.483923 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m07:30:56.485019 [debug] [ThreadPool]: On list_itsm_db_public: ROLLBACK
[0m07:30:56.485384 [debug] [ThreadPool]: On list_itsm_db_public: Close
[0m07:30:56.489762 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:56.490090 [debug] [MainThread]: On master: BEGIN
[0m07:30:56.490362 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:56.496823 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:30:56.497158 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:56.497549 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:30:56.502097 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m07:30:56.503041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd58cc040-97b6-4156-b0c4-9ed9877ab70d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7ce69b0>]}
[0m07:30:56.503430 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:56.503793 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:56.504082 [debug] [MainThread]: On master: BEGIN
[0m07:30:56.504521 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:30:56.504852 [debug] [MainThread]: On master: COMMIT
[0m07:30:56.505104 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:56.505350 [debug] [MainThread]: On master: COMMIT
[0m07:30:56.505708 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:30:56.506030 [debug] [MainThread]: On master: Close
[0m07:30:56.506628 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:30:56.506988 [info ] [MainThread]: 
[0m07:30:56.510161 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.tickets_analysis
[0m07:30:56.510704 [info ] [Thread-1 (]: 1 of 4 START sql table model public.tickets_analysis ........................... [RUN]
[0m07:30:56.511521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_itsm_db_public, now model.itsm_dbt_project.tickets_analysis)
[0m07:30:56.511910 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.tickets_analysis
[0m07:30:56.518676 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.tickets_analysis"
[0m07:30:56.519821 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.tickets_analysis (compile): 07:30:56.512134 => 07:30:56.519610
[0m07:30:56.520160 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.tickets_analysis
[0m07:30:56.551040 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.tickets_analysis"
[0m07:30:56.552050 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:30:56.552411 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: BEGIN
[0m07:30:56.552774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:56.559693 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:30:56.560111 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:30:56.560477 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */

  
    

  create  table "itsm_db"."public"."tickets_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH cleaned AS (
    SELECT DISTINCT
        inc_number AS ticket_id,
        inc_category AS category,
        inc_short_description AS sub_category,
        inc_priority AS priority,
        inc_state AS status,
        inc_assignment_group AS assigned_group,
        inc_assigned_to AS technician,
        NULL::float AS resolution_time_hrs,
        inc_sys_created_on::timestamp AS created_date,
        inc_resolved_at::timestamp AS resolved_date,
        NULL::text AS customer_impact
    FROM "itsm_db"."public"."tickets_raw"
    WHERE inc_number IS NOT NULL
)
SELECT
    *,
    EXTRACT(YEAR FROM created_date) AS created_year,
    EXTRACT(MONTH FROM created_date) AS created_month,
    EXTRACT(DAY FROM created_date) AS created_day,
    CASE WHEN status ILIKE 'closed' OR resolved_date IS NOT NULL THEN 1 ELSE 0 END AS is_closed
FROM cleaned
  );
  
[0m07:30:56.586021 [debug] [Thread-1 (]: SQL status: SELECT 4918 in 0.0 seconds
[0m07:30:56.591400 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:30:56.591795 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */
alter table "itsm_db"."public"."tickets_analysis" rename to "tickets_analysis__dbt_backup"
[0m07:30:56.592285 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:30:56.594720 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:30:56.595055 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */
alter table "itsm_db"."public"."tickets_analysis__dbt_tmp" rename to "tickets_analysis"
[0m07:30:56.596094 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:30:56.611349 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: COMMIT
[0m07:30:56.611841 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:30:56.612256 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: COMMIT
[0m07:30:56.615827 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:30:56.621117 [debug] [Thread-1 (]: Applying DROP to: "itsm_db"."public"."tickets_analysis__dbt_backup"
[0m07:30:56.624565 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:30:56.624959 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */
drop table if exists "itsm_db"."public"."tickets_analysis__dbt_backup" cascade
[0m07:30:56.629464 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m07:30:56.630676 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.tickets_analysis (execute): 07:30:56.520400 => 07:30:56.630499
[0m07:30:56.630988 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: Close
[0m07:30:56.631633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd58cc040-97b6-4156-b0c4-9ed9877ab70d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cd7310>]}
[0m07:30:56.632664 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.tickets_analysis ...................... [[32mSELECT 4918[0m in 0.12s]
[0m07:30:56.633304 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.tickets_analysis
[0m07:30:56.634919 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m07:30:56.635347 [info ] [Thread-1 (]: 2 of 4 START sql table model public.avg_resolution_by_cat_priority ............. [RUN]
[0m07:30:56.636208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.itsm_dbt_project.tickets_analysis, now model.itsm_dbt_project.avg_resolution_by_cat_priority)
[0m07:30:56.636630 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m07:30:56.639938 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m07:30:56.641357 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.avg_resolution_by_cat_priority (compile): 07:30:56.636926 => 07:30:56.641134
[0m07:30:56.641705 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m07:30:56.670480 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m07:30:56.671856 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m07:30:56.672245 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: BEGIN
[0m07:30:56.672585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:56.679703 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:30:56.680118 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m07:30:56.680443 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.avg_resolution_by_cat_priority"} */

  
    

  create  table "itsm_db"."public"."avg_resolution_by_cat_priority__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    category,
    priority,
    AVG(resolution_time_hrs) AS avg_resolution_hours,
    COUNT(ticket_id) AS total_tickets
FROM "itsm_db"."public"."tickets_analysis"
WHERE resolution_time_hrs IS NOT NULL
GROUP BY category, priority
ORDER BY category, priority;
  );
  
[0m07:30:56.681272 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 22: ORDER BY category, priority;
                                    ^

[0m07:30:56.681588 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: ROLLBACK
[0m07:30:56.682166 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.avg_resolution_by_cat_priority (execute): 07:30:56.642207 => 07:30:56.681938
[0m07:30:56.682616 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: Close
[0m07:30:56.685416 [debug] [Thread-1 (]: Database Error in model avg_resolution_by_cat_priority (models/models/avg_resolution_by_cat_priority.sql)
  syntax error at or near ";"
  LINE 22: ORDER BY category, priority;
                                      ^
  compiled Code at target/run/itsm_dbt_project/models/models/avg_resolution_by_cat_priority.sql
[0m07:30:56.685894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd58cc040-97b6-4156-b0c4-9ed9877ab70d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7be0790>]}
[0m07:30:56.686412 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.avg_resolution_by_cat_priority .... [[31mERROR[0m in 0.05s]
[0m07:30:56.687118 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m07:30:56.687517 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.closure_rate_by_group
[0m07:30:56.688015 [info ] [Thread-1 (]: 3 of 4 START sql table model public.closure_rate_by_group ...................... [RUN]
[0m07:30:56.688738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.itsm_dbt_project.avg_resolution_by_cat_priority, now model.itsm_dbt_project.closure_rate_by_group)
[0m07:30:56.689108 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.closure_rate_by_group
[0m07:30:56.691747 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.closure_rate_by_group"
[0m07:30:56.692942 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.closure_rate_by_group (compile): 07:30:56.689324 => 07:30:56.692744
[0m07:30:56.693270 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.closure_rate_by_group
[0m07:30:56.696682 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.closure_rate_by_group"
[0m07:30:56.697552 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m07:30:56.697884 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: BEGIN
[0m07:30:56.698172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:56.705049 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:30:56.705410 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m07:30:56.705737 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.closure_rate_by_group"} */

  
    

  create  table "itsm_db"."public"."closure_rate_by_group__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    assigned_group,
    COUNT(ticket_id) AS total_tickets,
    SUM(is_closed) AS closed_tickets,
    ROUND( (SUM(is_closed)::decimal / COUNT(ticket_id)) * 100, 2) AS closure_rate_percent
FROM "itsm_db"."public"."tickets_analysis"
GROUP BY assigned_group
ORDER BY closure_rate_percent DESC;
  );
  
[0m07:30:56.706190 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: ORDER BY closure_rate_percent DESC;
                                           ^

[0m07:30:56.706495 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: ROLLBACK
[0m07:30:56.707091 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.closure_rate_by_group (execute): 07:30:56.693479 => 07:30:56.706792
[0m07:30:56.707573 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: Close
[0m07:30:56.708843 [debug] [Thread-1 (]: Database Error in model closure_rate_by_group (models/models/closure_rate_by_group.sql)
  syntax error at or near ";"
  LINE 21: ORDER BY closure_rate_percent DESC;
                                             ^
  compiled Code at target/run/itsm_dbt_project/models/models/closure_rate_by_group.sql
[0m07:30:56.709275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd58cc040-97b6-4156-b0c4-9ed9877ab70d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8f738e0>]}
[0m07:30:56.709848 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.closure_rate_by_group ............. [[31mERROR[0m in 0.02s]
[0m07:30:56.710500 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.closure_rate_by_group
[0m07:30:56.710942 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.monthly_ticket_summary
[0m07:30:56.711379 [info ] [Thread-1 (]: 4 of 4 START sql table model public.monthly_ticket_summary ..................... [RUN]
[0m07:30:56.712121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.itsm_dbt_project.closure_rate_by_group, now model.itsm_dbt_project.monthly_ticket_summary)
[0m07:30:56.712441 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.monthly_ticket_summary
[0m07:30:56.715058 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.monthly_ticket_summary"
[0m07:30:56.716100 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.monthly_ticket_summary (compile): 07:30:56.712632 => 07:30:56.715898
[0m07:30:56.716453 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.monthly_ticket_summary
[0m07:30:56.720380 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.monthly_ticket_summary"
[0m07:30:56.721284 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.monthly_ticket_summary"
[0m07:30:56.721609 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: BEGIN
[0m07:30:56.721898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:56.729272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:30:56.729735 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.monthly_ticket_summary"
[0m07:30:56.730111 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.monthly_ticket_summary"} */

  
    

  create  table "itsm_db"."public"."monthly_ticket_summary__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    created_year,
    created_month,
    COUNT(ticket_id) AS tickets_created,
    SUM(is_closed) AS tickets_closed
FROM "itsm_db"."public"."tickets_analysis"
GROUP BY created_year, created_month
ORDER BY created_year, created_month;
  );
  
[0m07:30:56.730604 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: ORDER BY created_year, created_month;
                                             ^

[0m07:30:56.730933 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: ROLLBACK
[0m07:30:56.731392 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.monthly_ticket_summary (execute): 07:30:56.716700 => 07:30:56.731215
[0m07:30:56.731719 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: Close
[0m07:30:56.733074 [debug] [Thread-1 (]: Database Error in model monthly_ticket_summary (models/models/monthly_ticket_summary.sql)
  syntax error at or near ";"
  LINE 21: ORDER BY created_year, created_month;
                                               ^
  compiled Code at target/run/itsm_dbt_project/models/models/monthly_ticket_summary.sql
[0m07:30:56.733521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd58cc040-97b6-4156-b0c4-9ed9877ab70d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8f71480>]}
[0m07:30:56.734073 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.monthly_ticket_summary ............ [[31mERROR[0m in 0.02s]
[0m07:30:56.734759 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.monthly_ticket_summary
[0m07:30:56.736063 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:56.736412 [debug] [MainThread]: On master: BEGIN
[0m07:30:56.736702 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:56.743450 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:30:56.743823 [debug] [MainThread]: On master: COMMIT
[0m07:30:56.744137 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:56.744441 [debug] [MainThread]: On master: COMMIT
[0m07:30:56.744766 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:30:56.745072 [debug] [MainThread]: On master: Close
[0m07:30:56.745691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:56.746001 [debug] [MainThread]: Connection 'list_itsm_db' was properly closed.
[0m07:30:56.746308 [debug] [MainThread]: Connection 'model.itsm_dbt_project.monthly_ticket_summary' was properly closed.
[0m07:30:56.746891 [info ] [MainThread]: 
[0m07:30:56.747250 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m07:30:56.748347 [debug] [MainThread]: Command end result
[0m07:30:56.756602 [info ] [MainThread]: 
[0m07:30:56.757079 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:30:56.757459 [info ] [MainThread]: 
[0m07:30:56.757925 [error] [MainThread]:   Database Error in model avg_resolution_by_cat_priority (models/models/avg_resolution_by_cat_priority.sql)
  syntax error at or near ";"
  LINE 22: ORDER BY category, priority;
                                      ^
  compiled Code at target/run/itsm_dbt_project/models/models/avg_resolution_by_cat_priority.sql
[0m07:30:56.758261 [info ] [MainThread]: 
[0m07:30:56.758924 [error] [MainThread]:   Database Error in model closure_rate_by_group (models/models/closure_rate_by_group.sql)
  syntax error at or near ";"
  LINE 21: ORDER BY closure_rate_percent DESC;
                                             ^
  compiled Code at target/run/itsm_dbt_project/models/models/closure_rate_by_group.sql
[0m07:30:56.759417 [info ] [MainThread]: 
[0m07:30:56.759831 [error] [MainThread]:   Database Error in model monthly_ticket_summary (models/models/monthly_ticket_summary.sql)
  syntax error at or near ";"
  LINE 21: ORDER BY created_year, created_month;
                                               ^
  compiled Code at target/run/itsm_dbt_project/models/models/monthly_ticket_summary.sql
[0m07:30:56.760232 [info ] [MainThread]: 
[0m07:30:56.760715 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=0 TOTAL=4
[0m07:30:56.761957 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.84361416, "process_user_time": 2.26495, "process_kernel_time": 0.131636, "process_mem_max_rss": "138976", "process_out_blocks": "2349", "command_success": false, "process_in_blocks": "0"}
[0m07:30:56.762458 [debug] [MainThread]: Command `dbt run` failed at 07:30:56.762359 after 0.84 seconds
[0m07:30:56.762783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd1b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9288c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8fc4790>]}
[0m07:30:56.763133 [debug] [MainThread]: Flushing usage events
[0m07:35:26.357394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd1b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41de0>]}


============================== 07:35:26.365094 | e04f57a0-f15b-416c-b68d-d84377dccfa8 ==============================
[0m07:35:26.365094 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:35:26.365927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:35:26.493664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e04f57a0-f15b-416c-b68d-d84377dccfa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41f30>]}
[0m07:35:26.558457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e04f57a0-f15b-416c-b68d-d84377dccfa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8fc4700>]}
[0m07:35:26.559069 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:35:26.568960 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m07:35:26.595622 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 0 files changed.
[0m07:35:26.596134 [debug] [MainThread]: Partial parsing: added file: itsm_dbt_project://models/closure_rate_by_group.sql
[0m07:35:26.596472 [debug] [MainThread]: Partial parsing: added file: itsm_dbt_project://models/avg_resolution_by_cat_priority.sql
[0m07:35:26.596808 [debug] [MainThread]: Partial parsing: added file: itsm_dbt_project://models/monthly_ticket_summary.sql
[0m07:35:26.597156 [debug] [MainThread]: Partial parsing: deleted file: itsm_dbt_project://models/models/monthly_ticket_summary.sql
[0m07:35:26.597474 [debug] [MainThread]: Partial parsing: deleted file: itsm_dbt_project://models/models/closure_rate_by_group.sql
[0m07:35:26.597753 [debug] [MainThread]: Partial parsing: deleted file: itsm_dbt_project://models/models/avg_resolution_by_cat_priority.sql
[0m07:35:26.737610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e04f57a0-f15b-416c-b68d-d84377dccfa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7ce98a0>]}
[0m07:35:26.752220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e04f57a0-f15b-416c-b68d-d84377dccfa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8ea2a70>]}
[0m07:35:26.752627 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:35:26.753023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e04f57a0-f15b-416c-b68d-d84377dccfa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8ea2a10>]}
[0m07:35:26.754651 [info ] [MainThread]: 
[0m07:35:26.755745 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:35:26.758070 [debug] [ThreadPool]: Acquiring new postgres connection 'list_itsm_db'
[0m07:35:26.766831 [debug] [ThreadPool]: Using postgres connection "list_itsm_db"
[0m07:35:26.767238 [debug] [ThreadPool]: On list_itsm_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "list_itsm_db"} */

    select distinct nspname from pg_namespace
  
[0m07:35:26.767595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:35:26.814659 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m07:35:26.816162 [debug] [ThreadPool]: On list_itsm_db: Close
[0m07:35:26.818679 [debug] [ThreadPool]: Acquiring new postgres connection 'list_itsm_db_public'
[0m07:35:26.823407 [debug] [ThreadPool]: Using postgres connection "list_itsm_db_public"
[0m07:35:26.823751 [debug] [ThreadPool]: On list_itsm_db_public: BEGIN
[0m07:35:26.824028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:35:26.831697 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:35:26.832212 [debug] [ThreadPool]: Using postgres connection "list_itsm_db_public"
[0m07:35:26.832643 [debug] [ThreadPool]: On list_itsm_db_public: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "list_itsm_db_public"} */
select
      'itsm_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'itsm_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'itsm_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:35:26.837015 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m07:35:26.838160 [debug] [ThreadPool]: On list_itsm_db_public: ROLLBACK
[0m07:35:26.838529 [debug] [ThreadPool]: On list_itsm_db_public: Close
[0m07:35:26.842936 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:26.843258 [debug] [MainThread]: On master: BEGIN
[0m07:35:26.843538 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:35:26.849763 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:35:26.850085 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:26.850463 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:35:26.853271 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m07:35:26.854159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e04f57a0-f15b-416c-b68d-d84377dccfa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cd6980>]}
[0m07:35:26.854573 [debug] [MainThread]: On master: ROLLBACK
[0m07:35:26.854899 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:26.855187 [debug] [MainThread]: On master: BEGIN
[0m07:35:26.855546 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:35:26.855836 [debug] [MainThread]: On master: COMMIT
[0m07:35:26.856127 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:26.856364 [debug] [MainThread]: On master: COMMIT
[0m07:35:26.856629 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:35:26.856889 [debug] [MainThread]: On master: Close
[0m07:35:26.857479 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:35:26.857816 [info ] [MainThread]: 
[0m07:35:26.860602 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.tickets_analysis
[0m07:35:26.861153 [info ] [Thread-1 (]: 1 of 4 START sql table model public.tickets_analysis ........................... [RUN]
[0m07:35:26.861953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_itsm_db_public, now model.itsm_dbt_project.tickets_analysis)
[0m07:35:26.862447 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.tickets_analysis
[0m07:35:26.869347 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.tickets_analysis"
[0m07:35:26.871115 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.tickets_analysis (compile): 07:35:26.862731 => 07:35:26.870922
[0m07:35:26.871452 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.tickets_analysis
[0m07:35:26.901927 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.tickets_analysis"
[0m07:35:26.903062 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:35:26.903412 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: BEGIN
[0m07:35:26.903718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:35:26.910736 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:35:26.911323 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:35:26.911740 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */

  
    

  create  table "itsm_db"."public"."tickets_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH cleaned AS (
    SELECT DISTINCT
        inc_number AS ticket_id,
        inc_category AS category,
        inc_short_description AS sub_category,
        inc_priority AS priority,
        inc_state AS status,
        inc_assignment_group AS assigned_group,
        inc_assigned_to AS technician,
        NULL::float AS resolution_time_hrs,
        inc_sys_created_on::timestamp AS created_date,
        inc_resolved_at::timestamp AS resolved_date,
        NULL::text AS customer_impact
    FROM "itsm_db"."public"."tickets_raw"
    WHERE inc_number IS NOT NULL
)
SELECT
    *,
    EXTRACT(YEAR FROM created_date) AS created_year,
    EXTRACT(MONTH FROM created_date) AS created_month,
    EXTRACT(DAY FROM created_date) AS created_day,
    CASE WHEN status ILIKE 'closed' OR resolved_date IS NOT NULL THEN 1 ELSE 0 END AS is_closed
FROM cleaned
  );
  
[0m07:35:26.936502 [debug] [Thread-1 (]: SQL status: SELECT 4918 in 0.0 seconds
[0m07:35:26.941820 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:35:26.942203 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */
alter table "itsm_db"."public"."tickets_analysis" rename to "tickets_analysis__dbt_backup"
[0m07:35:26.942724 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:35:26.945296 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:35:26.945636 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */
alter table "itsm_db"."public"."tickets_analysis__dbt_tmp" rename to "tickets_analysis"
[0m07:35:26.946184 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:35:26.961275 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: COMMIT
[0m07:35:26.961749 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:35:26.962108 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: COMMIT
[0m07:35:26.964046 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:35:26.969028 [debug] [Thread-1 (]: Applying DROP to: "itsm_db"."public"."tickets_analysis__dbt_backup"
[0m07:35:26.972652 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:35:26.973030 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */
drop table if exists "itsm_db"."public"."tickets_analysis__dbt_backup" cascade
[0m07:35:26.976352 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m07:35:26.977526 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.tickets_analysis (execute): 07:35:26.871675 => 07:35:26.977340
[0m07:35:26.977833 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: Close
[0m07:35:26.978525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e04f57a0-f15b-416c-b68d-d84377dccfa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cdae90>]}
[0m07:35:26.980769 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.tickets_analysis ...................... [[32mSELECT 4918[0m in 0.12s]
[0m07:35:26.981573 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.tickets_analysis
[0m07:35:26.983222 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m07:35:26.983692 [info ] [Thread-1 (]: 2 of 4 START sql table model public.avg_resolution_by_cat_priority ............. [RUN]
[0m07:35:26.984487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.itsm_dbt_project.tickets_analysis, now model.itsm_dbt_project.avg_resolution_by_cat_priority)
[0m07:35:26.984852 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m07:35:26.988222 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m07:35:26.989226 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.avg_resolution_by_cat_priority (compile): 07:35:26.985095 => 07:35:26.989012
[0m07:35:26.989583 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m07:35:27.018359 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m07:35:27.019424 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m07:35:27.019786 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: BEGIN
[0m07:35:27.020132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:35:27.027000 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:35:27.027397 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m07:35:27.027813 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.avg_resolution_by_cat_priority"} */

  
    

  create  table "itsm_db"."public"."avg_resolution_by_cat_priority__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    category,
    priority,
    AVG(resolution_time_hrs) AS avg_resolution_hours,
    COUNT(ticket_id) AS total_tickets
FROM "itsm_db"."public"."tickets_analysis"
WHERE resolution_time_hrs IS NOT NULL
GROUP BY category, priority
ORDER BY category, priority;
  );
  
[0m07:35:27.028802 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 22: ORDER BY category, priority;
                                    ^

[0m07:35:27.029142 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: ROLLBACK
[0m07:35:27.029591 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.avg_resolution_by_cat_priority (execute): 07:35:26.989807 => 07:35:27.029426
[0m07:35:27.029887 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: Close
[0m07:35:27.033256 [debug] [Thread-1 (]: Database Error in model avg_resolution_by_cat_priority (models/avg_resolution_by_cat_priority.sql)
  syntax error at or near ";"
  LINE 22: ORDER BY category, priority;
                                      ^
  compiled Code at target/run/itsm_dbt_project/models/avg_resolution_by_cat_priority.sql
[0m07:35:27.033748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e04f57a0-f15b-416c-b68d-d84377dccfa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7bd8fa0>]}
[0m07:35:27.034287 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.avg_resolution_by_cat_priority .... [[31mERROR[0m in 0.05s]
[0m07:35:27.034878 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m07:35:27.035325 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.closure_rate_by_group
[0m07:35:27.035801 [info ] [Thread-1 (]: 3 of 4 START sql table model public.closure_rate_by_group ...................... [RUN]
[0m07:35:27.036532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.itsm_dbt_project.avg_resolution_by_cat_priority, now model.itsm_dbt_project.closure_rate_by_group)
[0m07:35:27.036936 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.closure_rate_by_group
[0m07:35:27.039499 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.closure_rate_by_group"
[0m07:35:27.040382 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.closure_rate_by_group (compile): 07:35:27.037163 => 07:35:27.040219
[0m07:35:27.040686 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.closure_rate_by_group
[0m07:35:27.044097 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.closure_rate_by_group"
[0m07:35:27.044886 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m07:35:27.045333 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: BEGIN
[0m07:35:27.045668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:35:27.051817 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:35:27.052297 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m07:35:27.052689 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.closure_rate_by_group"} */

  
    

  create  table "itsm_db"."public"."closure_rate_by_group__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    assigned_group,
    COUNT(ticket_id) AS total_tickets,
    SUM(is_closed) AS closed_tickets,
    ROUND( (SUM(is_closed)::decimal / COUNT(ticket_id)) * 100, 2) AS closure_rate_percent
FROM "itsm_db"."public"."tickets_analysis"
GROUP BY assigned_group
ORDER BY closure_rate_percent DESC;
  );
  
[0m07:35:27.053327 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: ORDER BY closure_rate_percent DESC;
                                           ^

[0m07:35:27.053685 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: ROLLBACK
[0m07:35:27.054180 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.closure_rate_by_group (execute): 07:35:27.040890 => 07:35:27.054004
[0m07:35:27.054481 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: Close
[0m07:35:27.055515 [debug] [Thread-1 (]: Database Error in model closure_rate_by_group (models/closure_rate_by_group.sql)
  syntax error at or near ";"
  LINE 21: ORDER BY closure_rate_percent DESC;
                                             ^
  compiled Code at target/run/itsm_dbt_project/models/closure_rate_by_group.sql
[0m07:35:27.055995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e04f57a0-f15b-416c-b68d-d84377dccfa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaf9ff70>]}
[0m07:35:27.056466 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.closure_rate_by_group ............. [[31mERROR[0m in 0.02s]
[0m07:35:27.057092 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.closure_rate_by_group
[0m07:35:27.057435 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.monthly_ticket_summary
[0m07:35:27.057860 [info ] [Thread-1 (]: 4 of 4 START sql table model public.monthly_ticket_summary ..................... [RUN]
[0m07:35:27.058576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.itsm_dbt_project.closure_rate_by_group, now model.itsm_dbt_project.monthly_ticket_summary)
[0m07:35:27.058959 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.monthly_ticket_summary
[0m07:35:27.061627 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.monthly_ticket_summary"
[0m07:35:27.062849 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.monthly_ticket_summary (compile): 07:35:27.059214 => 07:35:27.062656
[0m07:35:27.063227 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.monthly_ticket_summary
[0m07:35:27.066607 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.monthly_ticket_summary"
[0m07:35:27.067332 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.monthly_ticket_summary"
[0m07:35:27.067657 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: BEGIN
[0m07:35:27.067962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:35:27.074567 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:35:27.075412 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.monthly_ticket_summary"
[0m07:35:27.075884 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.monthly_ticket_summary"} */

  
    

  create  table "itsm_db"."public"."monthly_ticket_summary__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    created_year,
    created_month,
    COUNT(ticket_id) AS tickets_created,
    SUM(is_closed) AS tickets_closed
FROM "itsm_db"."public"."tickets_analysis"
GROUP BY created_year, created_month
ORDER BY created_year, created_month;
  );
  
[0m07:35:27.076773 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: ORDER BY created_year, created_month;
                                             ^

[0m07:35:27.077515 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: ROLLBACK
[0m07:35:27.078156 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.monthly_ticket_summary (execute): 07:35:27.063454 => 07:35:27.077933
[0m07:35:27.078530 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: Close
[0m07:35:27.080097 [debug] [Thread-1 (]: Database Error in model monthly_ticket_summary (models/monthly_ticket_summary.sql)
  syntax error at or near ";"
  LINE 21: ORDER BY created_year, created_month;
                                               ^
  compiled Code at target/run/itsm_dbt_project/models/monthly_ticket_summary.sql
[0m07:35:27.080571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e04f57a0-f15b-416c-b68d-d84377dccfa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8f750c0>]}
[0m07:35:27.081124 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.monthly_ticket_summary ............ [[31mERROR[0m in 0.02s]
[0m07:35:27.081758 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.monthly_ticket_summary
[0m07:35:27.083222 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:27.083571 [debug] [MainThread]: On master: BEGIN
[0m07:35:27.083869 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:35:27.092116 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:35:27.092557 [debug] [MainThread]: On master: COMMIT
[0m07:35:27.092960 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:27.093327 [debug] [MainThread]: On master: COMMIT
[0m07:35:27.093931 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:35:27.094270 [debug] [MainThread]: On master: Close
[0m07:35:27.094999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:35:27.095720 [debug] [MainThread]: Connection 'list_itsm_db' was properly closed.
[0m07:35:27.096242 [debug] [MainThread]: Connection 'model.itsm_dbt_project.monthly_ticket_summary' was properly closed.
[0m07:35:27.096840 [info ] [MainThread]: 
[0m07:35:27.097255 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m07:35:27.098718 [debug] [MainThread]: Command end result
[0m07:35:27.107614 [info ] [MainThread]: 
[0m07:35:27.108105 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m07:35:27.108568 [info ] [MainThread]: 
[0m07:35:27.108952 [error] [MainThread]:   Database Error in model avg_resolution_by_cat_priority (models/avg_resolution_by_cat_priority.sql)
  syntax error at or near ";"
  LINE 22: ORDER BY category, priority;
                                      ^
  compiled Code at target/run/itsm_dbt_project/models/avg_resolution_by_cat_priority.sql
[0m07:35:27.109337 [info ] [MainThread]: 
[0m07:35:27.109694 [error] [MainThread]:   Database Error in model closure_rate_by_group (models/closure_rate_by_group.sql)
  syntax error at or near ";"
  LINE 21: ORDER BY closure_rate_percent DESC;
                                             ^
  compiled Code at target/run/itsm_dbt_project/models/closure_rate_by_group.sql
[0m07:35:27.110177 [info ] [MainThread]: 
[0m07:35:27.110507 [error] [MainThread]:   Database Error in model monthly_ticket_summary (models/monthly_ticket_summary.sql)
  syntax error at or near ";"
  LINE 21: ORDER BY created_year, created_month;
                                               ^
  compiled Code at target/run/itsm_dbt_project/models/monthly_ticket_summary.sql
[0m07:35:27.110876 [info ] [MainThread]: 
[0m07:35:27.111327 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=0 TOTAL=4
[0m07:35:27.112861 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8034293, "process_user_time": 2.225141, "process_kernel_time": 0.15608, "process_mem_max_rss": "138808", "process_out_blocks": "2349", "command_success": false, "process_in_blocks": "0"}
[0m07:35:27.113414 [debug] [MainThread]: Command `dbt run` failed at 07:35:27.113315 after 0.80 seconds
[0m07:35:27.113791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd1b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff910c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff910ef80>]}
[0m07:35:27.114170 [debug] [MainThread]: Flushing usage events
[0m07:41:18.338262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd1b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41e40>]}


============================== 07:41:18.346394 | d72373f1-c7a3-4828-9e1e-739282a2349d ==============================
[0m07:41:18.346394 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:41:18.347234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:41:18.475534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd72373f1-c7a3-4828-9e1e-739282a2349d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41f90>]}
[0m07:41:18.540750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd72373f1-c7a3-4828-9e1e-739282a2349d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8fc4790>]}
[0m07:41:18.541449 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:41:18.550919 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m07:41:18.575683 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m07:41:18.576274 [debug] [MainThread]: Partial parsing: updated file: itsm_dbt_project://models/closure_rate_by_group.sql
[0m07:41:18.576687 [debug] [MainThread]: Partial parsing: updated file: itsm_dbt_project://models/monthly_ticket_summary.sql
[0m07:41:18.577042 [debug] [MainThread]: Partial parsing: updated file: itsm_dbt_project://models/avg_resolution_by_cat_priority.sql
[0m07:41:18.717010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd72373f1-c7a3-4828-9e1e-739282a2349d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7ced900>]}
[0m07:41:18.737449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd72373f1-c7a3-4828-9e1e-739282a2349d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8ea2ad0>]}
[0m07:41:18.737887 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:41:18.738268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd72373f1-c7a3-4828-9e1e-739282a2349d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8ea2a70>]}
[0m07:41:18.739979 [info ] [MainThread]: 
[0m07:41:18.741192 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:41:18.743308 [debug] [ThreadPool]: Acquiring new postgres connection 'list_itsm_db'
[0m07:41:18.752143 [debug] [ThreadPool]: Using postgres connection "list_itsm_db"
[0m07:41:18.752592 [debug] [ThreadPool]: On list_itsm_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "list_itsm_db"} */

    select distinct nspname from pg_namespace
  
[0m07:41:18.752931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:41:18.801489 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m07:41:18.803383 [debug] [ThreadPool]: On list_itsm_db: Close
[0m07:41:18.806236 [debug] [ThreadPool]: Acquiring new postgres connection 'list_itsm_db_public'
[0m07:41:18.810882 [debug] [ThreadPool]: Using postgres connection "list_itsm_db_public"
[0m07:41:18.811212 [debug] [ThreadPool]: On list_itsm_db_public: BEGIN
[0m07:41:18.811504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:41:18.818776 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:41:18.819094 [debug] [ThreadPool]: Using postgres connection "list_itsm_db_public"
[0m07:41:18.819420 [debug] [ThreadPool]: On list_itsm_db_public: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "list_itsm_db_public"} */
select
      'itsm_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'itsm_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'itsm_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:41:18.822148 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m07:41:18.823221 [debug] [ThreadPool]: On list_itsm_db_public: ROLLBACK
[0m07:41:18.823670 [debug] [ThreadPool]: On list_itsm_db_public: Close
[0m07:41:18.828552 [debug] [MainThread]: Using postgres connection "master"
[0m07:41:18.828927 [debug] [MainThread]: On master: BEGIN
[0m07:41:18.829190 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:41:18.835329 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:41:18.835646 [debug] [MainThread]: Using postgres connection "master"
[0m07:41:18.836004 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:41:18.838678 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m07:41:18.839593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd72373f1-c7a3-4828-9e1e-739282a2349d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cde9e0>]}
[0m07:41:18.840003 [debug] [MainThread]: On master: ROLLBACK
[0m07:41:18.840332 [debug] [MainThread]: Using postgres connection "master"
[0m07:41:18.840607 [debug] [MainThread]: On master: BEGIN
[0m07:41:18.840976 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:41:18.841247 [debug] [MainThread]: On master: COMMIT
[0m07:41:18.841535 [debug] [MainThread]: Using postgres connection "master"
[0m07:41:18.841802 [debug] [MainThread]: On master: COMMIT
[0m07:41:18.842072 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:41:18.842339 [debug] [MainThread]: On master: Close
[0m07:41:18.842887 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:41:18.843242 [info ] [MainThread]: 
[0m07:41:18.845982 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.tickets_analysis
[0m07:41:18.846624 [info ] [Thread-1 (]: 1 of 4 START sql table model public.tickets_analysis ........................... [RUN]
[0m07:41:18.847471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_itsm_db_public, now model.itsm_dbt_project.tickets_analysis)
[0m07:41:18.847896 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.tickets_analysis
[0m07:41:18.854968 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.tickets_analysis"
[0m07:41:18.856732 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.tickets_analysis (compile): 07:41:18.848120 => 07:41:18.856516
[0m07:41:18.857062 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.tickets_analysis
[0m07:41:18.887097 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.tickets_analysis"
[0m07:41:18.888050 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:41:18.888368 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: BEGIN
[0m07:41:18.888677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:41:18.895357 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:41:18.895752 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:41:18.896088 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */

  
    

  create  table "itsm_db"."public"."tickets_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH cleaned AS (
    SELECT DISTINCT
        inc_number AS ticket_id,
        inc_category AS category,
        inc_short_description AS sub_category,
        inc_priority AS priority,
        inc_state AS status,
        inc_assignment_group AS assigned_group,
        inc_assigned_to AS technician,
        NULL::float AS resolution_time_hrs,
        inc_sys_created_on::timestamp AS created_date,
        inc_resolved_at::timestamp AS resolved_date,
        NULL::text AS customer_impact
    FROM "itsm_db"."public"."tickets_raw"
    WHERE inc_number IS NOT NULL
)
SELECT
    *,
    EXTRACT(YEAR FROM created_date) AS created_year,
    EXTRACT(MONTH FROM created_date) AS created_month,
    EXTRACT(DAY FROM created_date) AS created_day,
    CASE WHEN status ILIKE 'closed' OR resolved_date IS NOT NULL THEN 1 ELSE 0 END AS is_closed
FROM cleaned
  );
  
[0m07:41:18.923733 [debug] [Thread-1 (]: SQL status: SELECT 4918 in 0.0 seconds
[0m07:41:18.928836 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:41:18.929204 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */
alter table "itsm_db"."public"."tickets_analysis" rename to "tickets_analysis__dbt_backup"
[0m07:41:18.929776 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:41:18.932112 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:41:18.932477 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */
alter table "itsm_db"."public"."tickets_analysis__dbt_tmp" rename to "tickets_analysis"
[0m07:41:18.933766 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:41:18.949198 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: COMMIT
[0m07:41:18.949597 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:41:18.949909 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: COMMIT
[0m07:41:18.953203 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:41:18.958116 [debug] [Thread-1 (]: Applying DROP to: "itsm_db"."public"."tickets_analysis__dbt_backup"
[0m07:41:18.961800 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:41:18.962137 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */
drop table if exists "itsm_db"."public"."tickets_analysis__dbt_backup" cascade
[0m07:41:18.965521 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m07:41:18.966713 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.tickets_analysis (execute): 07:41:18.857286 => 07:41:18.966544
[0m07:41:18.967030 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: Close
[0m07:41:18.967747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd72373f1-c7a3-4828-9e1e-739282a2349d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7ce2ef0>]}
[0m07:41:18.968745 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.tickets_analysis ...................... [[32mSELECT 4918[0m in 0.12s]
[0m07:41:18.969469 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.tickets_analysis
[0m07:41:18.971153 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m07:41:18.971664 [info ] [Thread-1 (]: 2 of 4 START sql table model public.avg_resolution_by_cat_priority ............. [RUN]
[0m07:41:18.972399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.itsm_dbt_project.tickets_analysis, now model.itsm_dbt_project.avg_resolution_by_cat_priority)
[0m07:41:18.972776 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m07:41:18.976061 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m07:41:18.977115 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.avg_resolution_by_cat_priority (compile): 07:41:18.972979 => 07:41:18.976878
[0m07:41:18.977497 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m07:41:19.006333 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m07:41:19.007418 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m07:41:19.007779 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: BEGIN
[0m07:41:19.008094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:41:19.015285 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:41:19.015741 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m07:41:19.016200 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.avg_resolution_by_cat_priority"} */

  
    

  create  table "itsm_db"."public"."avg_resolution_by_cat_priority__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    category,
    priority,
    AVG(resolution_time_hrs) AS avg_resolution_hours,
    COUNT(ticket_id) AS total_tickets
FROM "itsm_db"."public"."tickets_analysis"
WHERE resolution_time_hrs IS NOT NULL
GROUP BY category, priority
ORDER BY category, priority
  );
  
[0m07:41:19.021784 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m07:41:19.024279 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m07:41:19.024606 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.avg_resolution_by_cat_priority"} */
alter table "itsm_db"."public"."avg_resolution_by_cat_priority__dbt_tmp" rename to "avg_resolution_by_cat_priority"
[0m07:41:19.025497 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:41:19.027020 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: COMMIT
[0m07:41:19.027362 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m07:41:19.027672 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: COMMIT
[0m07:41:19.028279 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:41:19.030321 [debug] [Thread-1 (]: Applying DROP to: "itsm_db"."public"."avg_resolution_by_cat_priority__dbt_backup"
[0m07:41:19.031082 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m07:41:19.031446 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.avg_resolution_by_cat_priority"} */
drop table if exists "itsm_db"."public"."avg_resolution_by_cat_priority__dbt_backup" cascade
[0m07:41:19.031839 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m07:41:19.032934 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.avg_resolution_by_cat_priority (execute): 07:41:18.977753 => 07:41:19.032773
[0m07:41:19.033252 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: Close
[0m07:41:19.033962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd72373f1-c7a3-4828-9e1e-739282a2349d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8da0100>]}
[0m07:41:19.034480 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.avg_resolution_by_cat_priority ........ [[32mSELECT 0[0m in 0.06s]
[0m07:41:19.035465 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m07:41:19.035850 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.closure_rate_by_group
[0m07:41:19.036436 [info ] [Thread-1 (]: 3 of 4 START sql table model public.closure_rate_by_group ...................... [RUN]
[0m07:41:19.037623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.itsm_dbt_project.avg_resolution_by_cat_priority, now model.itsm_dbt_project.closure_rate_by_group)
[0m07:41:19.037973 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.closure_rate_by_group
[0m07:41:19.040541 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.closure_rate_by_group"
[0m07:41:19.041266 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.closure_rate_by_group (compile): 07:41:19.038173 => 07:41:19.041098
[0m07:41:19.041573 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.closure_rate_by_group
[0m07:41:19.044971 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.closure_rate_by_group"
[0m07:41:19.045584 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m07:41:19.045869 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: BEGIN
[0m07:41:19.046128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:41:19.053382 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:41:19.053756 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m07:41:19.054063 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.closure_rate_by_group"} */

  
    

  create  table "itsm_db"."public"."closure_rate_by_group__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    assigned_group,
    COUNT(*) AS total_tickets,
    SUM(CASE WHEN is_closed = 1 THEN 1 ELSE 0 END)::float / COUNT(*) * 100 AS closure_rate_percent
FROM "itsm_db"."public"."tickets_analysis"
GROUP BY assigned_group
ORDER BY closure_rate_percent DESC
  );
  
[0m07:41:19.058059 [debug] [Thread-1 (]: SQL status: SELECT 181 in 0.0 seconds
[0m07:41:19.060776 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m07:41:19.061120 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.closure_rate_by_group"} */
alter table "itsm_db"."public"."closure_rate_by_group__dbt_tmp" rename to "closure_rate_by_group"
[0m07:41:19.061662 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:41:19.063156 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: COMMIT
[0m07:41:19.063464 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m07:41:19.063781 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: COMMIT
[0m07:41:19.064509 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:41:19.066578 [debug] [Thread-1 (]: Applying DROP to: "itsm_db"."public"."closure_rate_by_group__dbt_backup"
[0m07:41:19.068294 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m07:41:19.068739 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.closure_rate_by_group"} */
drop table if exists "itsm_db"."public"."closure_rate_by_group__dbt_backup" cascade
[0m07:41:19.069170 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m07:41:19.070286 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.closure_rate_by_group (execute): 07:41:19.041762 => 07:41:19.070136
[0m07:41:19.070608 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: Close
[0m07:41:19.071249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd72373f1-c7a3-4828-9e1e-739282a2349d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cc5ab0>]}
[0m07:41:19.072624 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.closure_rate_by_group ................. [[32mSELECT 181[0m in 0.03s]
[0m07:41:19.073251 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.closure_rate_by_group
[0m07:41:19.073688 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.monthly_ticket_summary
[0m07:41:19.074092 [info ] [Thread-1 (]: 4 of 4 START sql table model public.monthly_ticket_summary ..................... [RUN]
[0m07:41:19.074804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.itsm_dbt_project.closure_rate_by_group, now model.itsm_dbt_project.monthly_ticket_summary)
[0m07:41:19.075155 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.monthly_ticket_summary
[0m07:41:19.077682 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.monthly_ticket_summary"
[0m07:41:19.078518 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.monthly_ticket_summary (compile): 07:41:19.075345 => 07:41:19.078333
[0m07:41:19.078835 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.monthly_ticket_summary
[0m07:41:19.082214 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.monthly_ticket_summary"
[0m07:41:19.082966 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.monthly_ticket_summary"
[0m07:41:19.083376 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: BEGIN
[0m07:41:19.083725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:41:19.091147 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:41:19.091753 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.monthly_ticket_summary"
[0m07:41:19.092132 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.monthly_ticket_summary"} */

  
    

  create  table "itsm_db"."public"."monthly_ticket_summary__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    EXTRACT(YEAR FROM created_date) AS created_year,
    EXTRACT(MONTH FROM created_date) AS created_month,
    COUNT(ticket_id) AS total_tickets,
    SUM(CASE WHEN is_closed = 1 THEN 1 ELSE 0 END) AS closed_tickets
FROM "itsm_db"."public"."tickets_analysis"
GROUP BY created_year, created_month
ORDER BY created_year, created_month
  );
  
[0m07:41:19.118068 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "tickets_analysis.created_date" must appear in the GROUP BY clause or be used in an aggregate function
LINE 15:     EXTRACT(YEAR FROM created_date) AS created_year,
                               ^

[0m07:41:19.122440 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: ROLLBACK
[0m07:41:19.126130 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.monthly_ticket_summary (execute): 07:41:19.079044 => 07:41:19.125533
[0m07:41:19.127236 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: Close
[0m07:41:19.132879 [debug] [Thread-1 (]: Database Error in model monthly_ticket_summary (models/monthly_ticket_summary.sql)
  column "tickets_analysis.created_date" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 15:     EXTRACT(YEAR FROM created_date) AS created_year,
                                 ^
  compiled Code at target/run/itsm_dbt_project/models/monthly_ticket_summary.sql
[0m07:41:19.133949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd72373f1-c7a3-4828-9e1e-739282a2349d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7d5beb0>]}
[0m07:41:19.134751 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.monthly_ticket_summary ............ [[31mERROR[0m in 0.06s]
[0m07:41:19.135670 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.monthly_ticket_summary
[0m07:41:19.137588 [debug] [MainThread]: Using postgres connection "master"
[0m07:41:19.138132 [debug] [MainThread]: On master: BEGIN
[0m07:41:19.138428 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:41:19.146729 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:41:19.147094 [debug] [MainThread]: On master: COMMIT
[0m07:41:19.147378 [debug] [MainThread]: Using postgres connection "master"
[0m07:41:19.147712 [debug] [MainThread]: On master: COMMIT
[0m07:41:19.148100 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:41:19.148419 [debug] [MainThread]: On master: Close
[0m07:41:19.149034 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:41:19.150641 [debug] [MainThread]: Connection 'list_itsm_db' was properly closed.
[0m07:41:19.150932 [debug] [MainThread]: Connection 'model.itsm_dbt_project.monthly_ticket_summary' was properly closed.
[0m07:41:19.151566 [info ] [MainThread]: 
[0m07:41:19.151904 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m07:41:19.153101 [debug] [MainThread]: Command end result
[0m07:41:19.160073 [info ] [MainThread]: 
[0m07:41:19.160517 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:41:19.160907 [info ] [MainThread]: 
[0m07:41:19.161237 [error] [MainThread]:   Database Error in model monthly_ticket_summary (models/monthly_ticket_summary.sql)
  column "tickets_analysis.created_date" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 15:     EXTRACT(YEAR FROM created_date) AS created_year,
                                 ^
  compiled Code at target/run/itsm_dbt_project/models/monthly_ticket_summary.sql
[0m07:41:19.161595 [info ] [MainThread]: 
[0m07:41:19.162048 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m07:41:19.163337 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8688537, "process_user_time": 2.251347, "process_kernel_time": 0.131311, "process_mem_max_rss": "139068", "process_out_blocks": "2352", "command_success": false, "process_in_blocks": "0"}
[0m07:41:19.163917 [debug] [MainThread]: Command `dbt run` failed at 07:41:19.163795 after 0.87 seconds
[0m07:41:19.164289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd1b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8fc4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cde9b0>]}
[0m07:41:19.164649 [debug] [MainThread]: Flushing usage events
[0m07:44:57.114791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd1b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41e70>]}


============================== 07:44:57.122612 | cd867fa1-2735-4d2a-9f09-1053ff531a62 ==============================
[0m07:44:57.122612 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:44:57.123464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:44:57.251645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd867fa1-2735-4d2a-9f09-1053ff531a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41fc0>]}
[0m07:44:57.316310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd867fa1-2735-4d2a-9f09-1053ff531a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8fc6230>]}
[0m07:44:57.316926 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:44:57.326603 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m07:44:57.354017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:44:57.354574 [debug] [MainThread]: Partial parsing: updated file: itsm_dbt_project://models/monthly_ticket_summary.sql
[0m07:44:57.489241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd867fa1-2735-4d2a-9f09-1053ff531a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7ce5930>]}
[0m07:44:57.504728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd867fa1-2735-4d2a-9f09-1053ff531a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8f5ebc0>]}
[0m07:44:57.505196 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:44:57.505697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd867fa1-2735-4d2a-9f09-1053ff531a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8f5ead0>]}
[0m07:44:57.507364 [info ] [MainThread]: 
[0m07:44:57.508595 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:44:57.510757 [debug] [ThreadPool]: Acquiring new postgres connection 'list_itsm_db'
[0m07:44:57.519744 [debug] [ThreadPool]: Using postgres connection "list_itsm_db"
[0m07:44:57.520167 [debug] [ThreadPool]: On list_itsm_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "list_itsm_db"} */

    select distinct nspname from pg_namespace
  
[0m07:44:57.520548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:57.569413 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m07:44:57.570914 [debug] [ThreadPool]: On list_itsm_db: Close
[0m07:44:57.573263 [debug] [ThreadPool]: Acquiring new postgres connection 'list_itsm_db_public'
[0m07:44:57.577954 [debug] [ThreadPool]: Using postgres connection "list_itsm_db_public"
[0m07:44:57.578316 [debug] [ThreadPool]: On list_itsm_db_public: BEGIN
[0m07:44:57.578604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:57.586505 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:44:57.586902 [debug] [ThreadPool]: Using postgres connection "list_itsm_db_public"
[0m07:44:57.587223 [debug] [ThreadPool]: On list_itsm_db_public: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "list_itsm_db_public"} */
select
      'itsm_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'itsm_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'itsm_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:44:57.589960 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m07:44:57.591144 [debug] [ThreadPool]: On list_itsm_db_public: ROLLBACK
[0m07:44:57.591600 [debug] [ThreadPool]: On list_itsm_db_public: Close
[0m07:44:57.596231 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:57.596557 [debug] [MainThread]: On master: BEGIN
[0m07:44:57.596821 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:44:57.603313 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:44:57.603633 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:57.604050 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:44:57.607321 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m07:44:57.608229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd867fa1-2735-4d2a-9f09-1053ff531a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7ce2a70>]}
[0m07:44:57.608602 [debug] [MainThread]: On master: ROLLBACK
[0m07:44:57.608962 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:57.609221 [debug] [MainThread]: On master: BEGIN
[0m07:44:57.609635 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:44:57.609919 [debug] [MainThread]: On master: COMMIT
[0m07:44:57.610193 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:57.610481 [debug] [MainThread]: On master: COMMIT
[0m07:44:57.610822 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:44:57.611100 [debug] [MainThread]: On master: Close
[0m07:44:57.611691 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:44:57.612028 [info ] [MainThread]: 
[0m07:44:57.614977 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.tickets_analysis
[0m07:44:57.615558 [info ] [Thread-1 (]: 1 of 4 START sql table model public.tickets_analysis ........................... [RUN]
[0m07:44:57.616602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_itsm_db_public, now model.itsm_dbt_project.tickets_analysis)
[0m07:44:57.617016 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.tickets_analysis
[0m07:44:57.623929 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.tickets_analysis"
[0m07:44:57.624968 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.tickets_analysis (compile): 07:44:57.617304 => 07:44:57.624760
[0m07:44:57.625362 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.tickets_analysis
[0m07:44:57.655981 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.tickets_analysis"
[0m07:44:57.656972 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:44:57.657336 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: BEGIN
[0m07:44:57.657642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:57.664388 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:44:57.664798 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:44:57.665209 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */

  
    

  create  table "itsm_db"."public"."tickets_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH cleaned AS (
    SELECT DISTINCT
        inc_number AS ticket_id,
        inc_category AS category,
        inc_short_description AS sub_category,
        inc_priority AS priority,
        inc_state AS status,
        inc_assignment_group AS assigned_group,
        inc_assigned_to AS technician,
        NULL::float AS resolution_time_hrs,
        inc_sys_created_on::timestamp AS created_date,
        inc_resolved_at::timestamp AS resolved_date,
        NULL::text AS customer_impact
    FROM "itsm_db"."public"."tickets_raw"
    WHERE inc_number IS NOT NULL
)
SELECT
    *,
    EXTRACT(YEAR FROM created_date) AS created_year,
    EXTRACT(MONTH FROM created_date) AS created_month,
    EXTRACT(DAY FROM created_date) AS created_day,
    CASE WHEN status ILIKE 'closed' OR resolved_date IS NOT NULL THEN 1 ELSE 0 END AS is_closed
FROM cleaned
  );
  
[0m07:44:57.691941 [debug] [Thread-1 (]: SQL status: SELECT 4918 in 0.0 seconds
[0m07:44:57.697188 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:44:57.697576 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */
alter table "itsm_db"."public"."tickets_analysis" rename to "tickets_analysis__dbt_backup"
[0m07:44:57.698142 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:44:57.700766 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:44:57.701156 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */
alter table "itsm_db"."public"."tickets_analysis__dbt_tmp" rename to "tickets_analysis"
[0m07:44:57.701891 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:44:57.717272 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: COMMIT
[0m07:44:57.717717 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:44:57.718067 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: COMMIT
[0m07:44:57.720361 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:44:57.725560 [debug] [Thread-1 (]: Applying DROP to: "itsm_db"."public"."tickets_analysis__dbt_backup"
[0m07:44:57.728973 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m07:44:57.729350 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */
drop table if exists "itsm_db"."public"."tickets_analysis__dbt_backup" cascade
[0m07:44:57.732792 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m07:44:57.734020 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.tickets_analysis (execute): 07:44:57.625591 => 07:44:57.733840
[0m07:44:57.734333 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: Close
[0m07:44:57.735012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd867fa1-2735-4d2a-9f09-1053ff531a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff910c430>]}
[0m07:44:57.735959 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.tickets_analysis ...................... [[32mSELECT 4918[0m in 0.12s]
[0m07:44:57.736672 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.tickets_analysis
[0m07:44:57.738411 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m07:44:57.738878 [info ] [Thread-1 (]: 2 of 4 START sql table model public.avg_resolution_by_cat_priority ............. [RUN]
[0m07:44:57.739596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.itsm_dbt_project.tickets_analysis, now model.itsm_dbt_project.avg_resolution_by_cat_priority)
[0m07:44:57.739928 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m07:44:57.742531 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m07:44:57.743503 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.avg_resolution_by_cat_priority (compile): 07:44:57.740123 => 07:44:57.743237
[0m07:44:57.743884 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m07:44:57.773551 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m07:44:57.774697 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m07:44:57.775102 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: BEGIN
[0m07:44:57.775445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:57.782815 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:44:57.783272 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m07:44:57.783630 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.avg_resolution_by_cat_priority"} */

  
    

  create  table "itsm_db"."public"."avg_resolution_by_cat_priority__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    category,
    priority,
    AVG(resolution_time_hrs) AS avg_resolution_hours,
    COUNT(ticket_id) AS total_tickets
FROM "itsm_db"."public"."tickets_analysis"
WHERE resolution_time_hrs IS NOT NULL
GROUP BY category, priority
ORDER BY category, priority
  );
  
[0m07:44:57.788075 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m07:44:57.790721 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m07:44:57.791093 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.avg_resolution_by_cat_priority"} */
alter table "itsm_db"."public"."avg_resolution_by_cat_priority" rename to "avg_resolution_by_cat_priority__dbt_backup"
[0m07:44:57.791559 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:44:57.793948 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m07:44:57.794302 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.avg_resolution_by_cat_priority"} */
alter table "itsm_db"."public"."avg_resolution_by_cat_priority__dbt_tmp" rename to "avg_resolution_by_cat_priority"
[0m07:44:57.794826 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:44:57.796428 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: COMMIT
[0m07:44:57.796725 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m07:44:57.797009 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: COMMIT
[0m07:44:57.797808 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:44:57.800118 [debug] [Thread-1 (]: Applying DROP to: "itsm_db"."public"."avg_resolution_by_cat_priority__dbt_backup"
[0m07:44:57.800797 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m07:44:57.801176 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.avg_resolution_by_cat_priority"} */
drop table if exists "itsm_db"."public"."avg_resolution_by_cat_priority__dbt_backup" cascade
[0m07:44:57.802969 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m07:44:57.804137 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.avg_resolution_by_cat_priority (execute): 07:44:57.744111 => 07:44:57.803973
[0m07:44:57.804452 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: Close
[0m07:44:57.805155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd867fa1-2735-4d2a-9f09-1053ff531a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7bd9e40>]}
[0m07:44:57.805707 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.avg_resolution_by_cat_priority ........ [[32mSELECT 0[0m in 0.07s]
[0m07:44:57.806311 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m07:44:57.806725 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.closure_rate_by_group
[0m07:44:57.807170 [info ] [Thread-1 (]: 3 of 4 START sql table model public.closure_rate_by_group ...................... [RUN]
[0m07:44:57.808023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.itsm_dbt_project.avg_resolution_by_cat_priority, now model.itsm_dbt_project.closure_rate_by_group)
[0m07:44:57.808372 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.closure_rate_by_group
[0m07:44:57.810861 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.closure_rate_by_group"
[0m07:44:57.811582 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.closure_rate_by_group (compile): 07:44:57.808577 => 07:44:57.811404
[0m07:44:57.811886 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.closure_rate_by_group
[0m07:44:57.815497 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.closure_rate_by_group"
[0m07:44:57.816553 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m07:44:57.817141 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: BEGIN
[0m07:44:57.817509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:57.824248 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:44:57.824640 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m07:44:57.824962 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.closure_rate_by_group"} */

  
    

  create  table "itsm_db"."public"."closure_rate_by_group__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    assigned_group,
    COUNT(*) AS total_tickets,
    SUM(CASE WHEN is_closed = 1 THEN 1 ELSE 0 END)::float / COUNT(*) * 100 AS closure_rate_percent
FROM "itsm_db"."public"."tickets_analysis"
GROUP BY assigned_group
ORDER BY closure_rate_percent DESC
  );
  
[0m07:44:57.830142 [debug] [Thread-1 (]: SQL status: SELECT 181 in 0.0 seconds
[0m07:44:57.833031 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m07:44:57.833369 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.closure_rate_by_group"} */
alter table "itsm_db"."public"."closure_rate_by_group" rename to "closure_rate_by_group__dbt_backup"
[0m07:44:57.833834 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:44:57.837696 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m07:44:57.838133 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.closure_rate_by_group"} */
alter table "itsm_db"."public"."closure_rate_by_group__dbt_tmp" rename to "closure_rate_by_group"
[0m07:44:57.838767 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:44:57.840536 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: COMMIT
[0m07:44:57.840939 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m07:44:57.841328 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: COMMIT
[0m07:44:57.842204 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:44:57.844354 [debug] [Thread-1 (]: Applying DROP to: "itsm_db"."public"."closure_rate_by_group__dbt_backup"
[0m07:44:57.845111 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m07:44:57.845450 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.closure_rate_by_group"} */
drop table if exists "itsm_db"."public"."closure_rate_by_group__dbt_backup" cascade
[0m07:44:57.847182 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m07:44:57.848301 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.closure_rate_by_group (execute): 07:44:57.812084 => 07:44:57.848146
[0m07:44:57.848616 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: Close
[0m07:44:57.849611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd867fa1-2735-4d2a-9f09-1053ff531a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7d238b0>]}
[0m07:44:57.850201 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.closure_rate_by_group ................. [[32mSELECT 181[0m in 0.04s]
[0m07:44:57.850812 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.closure_rate_by_group
[0m07:44:57.851243 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.monthly_ticket_summary
[0m07:44:57.851787 [info ] [Thread-1 (]: 4 of 4 START sql table model public.monthly_ticket_summary ..................... [RUN]
[0m07:44:57.852477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.itsm_dbt_project.closure_rate_by_group, now model.itsm_dbt_project.monthly_ticket_summary)
[0m07:44:57.852784 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.monthly_ticket_summary
[0m07:44:57.855344 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.monthly_ticket_summary"
[0m07:44:57.856046 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.monthly_ticket_summary (compile): 07:44:57.852972 => 07:44:57.855874
[0m07:44:57.856336 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.monthly_ticket_summary
[0m07:44:57.859791 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.monthly_ticket_summary"
[0m07:44:57.860612 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.monthly_ticket_summary"
[0m07:44:57.860930 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: BEGIN
[0m07:44:57.861275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:57.868226 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:44:57.868647 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.monthly_ticket_summary"
[0m07:44:57.868999 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.monthly_ticket_summary"} */

  
    

  create  table "itsm_db"."public"."monthly_ticket_summary__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    EXTRACT(YEAR FROM created_date) AS created_year,
    EXTRACT(MONTH FROM created_date) AS created_month,
    COUNT(ticket_id) AS total_tickets,
    SUM(CASE WHEN is_closed = 1 THEN 1 ELSE 0 END) AS closed_tickets
FROM "itsm_db"."public"."tickets_analysis"
GROUP BY EXTRACT(YEAR FROM created_date), EXTRACT(MONTH FROM created_date)
ORDER BY EXTRACT(YEAR FROM created_date), EXTRACT(MONTH FROM created_date)
  );
  
[0m07:44:57.873984 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m07:44:57.876731 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.monthly_ticket_summary"
[0m07:44:57.877131 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.monthly_ticket_summary"} */
alter table "itsm_db"."public"."monthly_ticket_summary__dbt_tmp" rename to "monthly_ticket_summary"
[0m07:44:57.877832 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m07:44:57.879381 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: COMMIT
[0m07:44:57.879701 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.monthly_ticket_summary"
[0m07:44:57.879970 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: COMMIT
[0m07:44:57.880699 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:44:57.883022 [debug] [Thread-1 (]: Applying DROP to: "itsm_db"."public"."monthly_ticket_summary__dbt_backup"
[0m07:44:57.883772 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.monthly_ticket_summary"
[0m07:44:57.884175 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.monthly_ticket_summary"} */
drop table if exists "itsm_db"."public"."monthly_ticket_summary__dbt_backup" cascade
[0m07:44:57.884620 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m07:44:57.885767 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.monthly_ticket_summary (execute): 07:44:57.856521 => 07:44:57.885606
[0m07:44:57.886081 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: Close
[0m07:44:57.886792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd867fa1-2735-4d2a-9f09-1053ff531a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7d68d60>]}
[0m07:44:57.887292 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.monthly_ticket_summary ................ [[32mSELECT 1[0m in 0.03s]
[0m07:44:57.887968 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.monthly_ticket_summary
[0m07:44:57.889230 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:57.889530 [debug] [MainThread]: On master: BEGIN
[0m07:44:57.889770 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:44:57.896164 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:44:57.896492 [debug] [MainThread]: On master: COMMIT
[0m07:44:57.896771 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:57.897048 [debug] [MainThread]: On master: COMMIT
[0m07:44:57.897387 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:44:57.897644 [debug] [MainThread]: On master: Close
[0m07:44:57.898233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:44:57.898541 [debug] [MainThread]: Connection 'list_itsm_db' was properly closed.
[0m07:44:57.898832 [debug] [MainThread]: Connection 'model.itsm_dbt_project.monthly_ticket_summary' was properly closed.
[0m07:44:57.899438 [info ] [MainThread]: 
[0m07:44:57.899999 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m07:44:57.901469 [debug] [MainThread]: Command end result
[0m07:44:57.908965 [info ] [MainThread]: 
[0m07:44:57.909436 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:44:57.909807 [info ] [MainThread]: 
[0m07:44:57.910285 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m07:44:57.911490 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8446423, "process_user_time": 2.276201, "process_kernel_time": 0.149144, "process_mem_max_rss": "138368", "process_out_blocks": "2355", "process_in_blocks": "0"}
[0m07:44:57.911976 [debug] [MainThread]: Command `dbt run` succeeded at 07:44:57.911877 after 0.85 seconds
[0m07:44:57.912300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd1b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8da1cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8da0a00>]}
[0m07:44:57.912659 [debug] [MainThread]: Flushing usage events
[0m08:33:20.374726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd1b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41e10>]}


============================== 08:33:20.382757 | a9d409ca-7d8a-478a-837d-a58ee5a219e1 ==============================
[0m08:33:20.382757 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:33:20.383663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:33:20.518805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9d409ca-7d8a-478a-837d-a58ee5a219e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41f60>]}
[0m08:33:20.585628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9d409ca-7d8a-478a-837d-a58ee5a219e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8fc4760>]}
[0m08:33:20.586361 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:33:20.595974 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m08:33:20.623141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:33:20.623708 [debug] [MainThread]: Partial parsing: updated file: itsm_dbt_project://models/avg_resolution_by_cat_priority.sql
[0m08:33:20.767034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9d409ca-7d8a-478a-837d-a58ee5a219e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7ced8d0>]}
[0m08:33:20.783551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9d409ca-7d8a-478a-837d-a58ee5a219e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8ea2b60>]}
[0m08:33:20.784121 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:33:20.784764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9d409ca-7d8a-478a-837d-a58ee5a219e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8ea2a70>]}
[0m08:33:20.787094 [info ] [MainThread]: 
[0m08:33:20.788669 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:33:20.790836 [debug] [ThreadPool]: Acquiring new postgres connection 'list_itsm_db'
[0m08:33:20.800852 [debug] [ThreadPool]: Using postgres connection "list_itsm_db"
[0m08:33:20.801345 [debug] [ThreadPool]: On list_itsm_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "list_itsm_db"} */

    select distinct nspname from pg_namespace
  
[0m08:33:20.801748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:33:20.859188 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m08:33:20.861064 [debug] [ThreadPool]: On list_itsm_db: Close
[0m08:33:20.863893 [debug] [ThreadPool]: Acquiring new postgres connection 'list_itsm_db_public'
[0m08:33:20.868952 [debug] [ThreadPool]: Using postgres connection "list_itsm_db_public"
[0m08:33:20.869349 [debug] [ThreadPool]: On list_itsm_db_public: BEGIN
[0m08:33:20.869710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:33:20.877712 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:33:20.878074 [debug] [ThreadPool]: Using postgres connection "list_itsm_db_public"
[0m08:33:20.878390 [debug] [ThreadPool]: On list_itsm_db_public: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "list_itsm_db_public"} */
select
      'itsm_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'itsm_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'itsm_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:33:20.881909 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m08:33:20.883137 [debug] [ThreadPool]: On list_itsm_db_public: ROLLBACK
[0m08:33:20.883563 [debug] [ThreadPool]: On list_itsm_db_public: Close
[0m08:33:20.888688 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:20.889073 [debug] [MainThread]: On master: BEGIN
[0m08:33:20.889381 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:33:20.896507 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:33:20.896875 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:20.897272 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:33:20.900845 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m08:33:20.901881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9d409ca-7d8a-478a-837d-a58ee5a219e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7cf6c80>]}
[0m08:33:20.902335 [debug] [MainThread]: On master: ROLLBACK
[0m08:33:20.902776 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:20.903081 [debug] [MainThread]: On master: BEGIN
[0m08:33:20.903514 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:33:20.903806 [debug] [MainThread]: On master: COMMIT
[0m08:33:20.904082 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:20.904351 [debug] [MainThread]: On master: COMMIT
[0m08:33:20.904683 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:33:20.904980 [debug] [MainThread]: On master: Close
[0m08:33:20.905631 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:33:20.906123 [info ] [MainThread]: 
[0m08:33:20.909682 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.tickets_analysis
[0m08:33:20.910497 [info ] [Thread-1 (]: 1 of 4 START sql table model public.tickets_analysis ........................... [RUN]
[0m08:33:20.911504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_itsm_db_public, now model.itsm_dbt_project.tickets_analysis)
[0m08:33:20.911912 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.tickets_analysis
[0m08:33:20.919156 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.tickets_analysis"
[0m08:33:20.920556 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.tickets_analysis (compile): 08:33:20.912181 => 08:33:20.920340
[0m08:33:20.920920 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.tickets_analysis
[0m08:33:20.964154 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.tickets_analysis"
[0m08:33:20.965657 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m08:33:20.966110 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: BEGIN
[0m08:33:20.966503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:33:20.974055 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m08:33:20.974570 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m08:33:20.974988 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */

  
    

  create  table "itsm_db"."public"."tickets_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH cleaned AS (
    SELECT DISTINCT
        inc_number AS ticket_id,
        inc_category AS category,
        inc_short_description AS sub_category,
        inc_priority AS priority,
        inc_state AS status,
        inc_assignment_group AS assigned_group,
        inc_assigned_to AS technician,
        NULL::float AS resolution_time_hrs,
        inc_sys_created_on::timestamp AS created_date,
        inc_resolved_at::timestamp AS resolved_date,
        NULL::text AS customer_impact
    FROM "itsm_db"."public"."tickets_raw"
    WHERE inc_number IS NOT NULL
)
SELECT
    *,
    EXTRACT(YEAR FROM created_date) AS created_year,
    EXTRACT(MONTH FROM created_date) AS created_month,
    EXTRACT(DAY FROM created_date) AS created_day,
    CASE WHEN status ILIKE 'closed' OR resolved_date IS NOT NULL THEN 1 ELSE 0 END AS is_closed
FROM cleaned
  );
  
[0m08:33:21.007047 [debug] [Thread-1 (]: SQL status: SELECT 4918 in 0.0 seconds
[0m08:33:21.012796 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m08:33:21.013262 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */
alter table "itsm_db"."public"."tickets_analysis" rename to "tickets_analysis__dbt_backup"
[0m08:33:21.013885 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:33:21.016432 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m08:33:21.016786 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */
alter table "itsm_db"."public"."tickets_analysis__dbt_tmp" rename to "tickets_analysis"
[0m08:33:21.017345 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:33:21.033121 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: COMMIT
[0m08:33:21.033583 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m08:33:21.033973 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: COMMIT
[0m08:33:21.037791 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:33:21.043008 [debug] [Thread-1 (]: Applying DROP to: "itsm_db"."public"."tickets_analysis__dbt_backup"
[0m08:33:21.046461 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m08:33:21.046827 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */
drop table if exists "itsm_db"."public"."tickets_analysis__dbt_backup" cascade
[0m08:33:21.051820 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m08:33:21.053101 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.tickets_analysis (execute): 08:33:20.921167 => 08:33:21.052933
[0m08:33:21.053449 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: Close
[0m08:33:21.054209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9d409ca-7d8a-478a-837d-a58ee5a219e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8f53ac0>]}
[0m08:33:21.055253 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.tickets_analysis ...................... [[32mSELECT 4918[0m in 0.14s]
[0m08:33:21.055952 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.tickets_analysis
[0m08:33:21.057548 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m08:33:21.057985 [info ] [Thread-1 (]: 2 of 4 START sql table model public.avg_resolution_by_cat_priority ............. [RUN]
[0m08:33:21.058806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.itsm_dbt_project.tickets_analysis, now model.itsm_dbt_project.avg_resolution_by_cat_priority)
[0m08:33:21.059418 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m08:33:21.062947 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m08:33:21.064174 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.avg_resolution_by_cat_priority (compile): 08:33:21.059765 => 08:33:21.063981
[0m08:33:21.064525 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m08:33:21.094261 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m08:33:21.095450 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m08:33:21.095861 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: BEGIN
[0m08:33:21.096177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:33:21.103812 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m08:33:21.104255 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m08:33:21.104665 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.avg_resolution_by_cat_priority"} */

  
    

  create  table "itsm_db"."public"."avg_resolution_by_cat_priority__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    category,
    priority,
    ROUND(
        AVG(
            COALESCE(
                resolution_time_hrs,
                EXTRACT(EPOCH FROM (resolved_date - created_date))/3600
            )
        )::numeric,
        2
    ) AS avg_resolution_hours
FROM "itsm_db"."public"."tickets_analysis"
GROUP BY category, priority
ORDER BY category, priority;
  );
  
[0m08:33:21.105714 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 28: ORDER BY category, priority;
                                    ^

[0m08:33:21.106092 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: ROLLBACK
[0m08:33:21.106737 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.avg_resolution_by_cat_priority (execute): 08:33:21.064785 => 08:33:21.106534
[0m08:33:21.107150 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: Close
[0m08:33:21.110067 [debug] [Thread-1 (]: Database Error in model avg_resolution_by_cat_priority (models/avg_resolution_by_cat_priority.sql)
  syntax error at or near ";"
  LINE 28: ORDER BY category, priority;
                                      ^
  compiled Code at target/run/itsm_dbt_project/models/avg_resolution_by_cat_priority.sql
[0m08:33:21.110579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9d409ca-7d8a-478a-837d-a58ee5a219e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7bd9f90>]}
[0m08:33:21.111147 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.avg_resolution_by_cat_priority .... [[31mERROR[0m in 0.05s]
[0m08:33:21.111790 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m08:33:21.112201 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.closure_rate_by_group
[0m08:33:21.112703 [info ] [Thread-1 (]: 3 of 4 START sql table model public.closure_rate_by_group ...................... [RUN]
[0m08:33:21.113524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.itsm_dbt_project.avg_resolution_by_cat_priority, now model.itsm_dbt_project.closure_rate_by_group)
[0m08:33:21.113876 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.closure_rate_by_group
[0m08:33:21.116481 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.closure_rate_by_group"
[0m08:33:21.117367 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.closure_rate_by_group (compile): 08:33:21.114093 => 08:33:21.117167
[0m08:33:21.117738 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.closure_rate_by_group
[0m08:33:21.121238 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.closure_rate_by_group"
[0m08:33:21.121966 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m08:33:21.122289 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: BEGIN
[0m08:33:21.122596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:33:21.129612 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m08:33:21.130037 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m08:33:21.130394 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.closure_rate_by_group"} */

  
    

  create  table "itsm_db"."public"."closure_rate_by_group__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    assigned_group,
    COUNT(*) AS total_tickets,
    SUM(CASE WHEN is_closed = 1 THEN 1 ELSE 0 END)::float / COUNT(*) * 100 AS closure_rate_percent
FROM "itsm_db"."public"."tickets_analysis"
GROUP BY assigned_group
ORDER BY closure_rate_percent DESC
  );
  
[0m08:33:21.135440 [debug] [Thread-1 (]: SQL status: SELECT 181 in 0.0 seconds
[0m08:33:21.138251 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m08:33:21.138645 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.closure_rate_by_group"} */
alter table "itsm_db"."public"."closure_rate_by_group" rename to "closure_rate_by_group__dbt_backup"
[0m08:33:21.139195 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:33:21.141557 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m08:33:21.141891 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.closure_rate_by_group"} */
alter table "itsm_db"."public"."closure_rate_by_group__dbt_tmp" rename to "closure_rate_by_group"
[0m08:33:21.142534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:33:21.144662 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: COMMIT
[0m08:33:21.145061 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m08:33:21.145387 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: COMMIT
[0m08:33:21.146141 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:33:21.148272 [debug] [Thread-1 (]: Applying DROP to: "itsm_db"."public"."closure_rate_by_group__dbt_backup"
[0m08:33:21.148964 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m08:33:21.149290 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.closure_rate_by_group"} */
drop table if exists "itsm_db"."public"."closure_rate_by_group__dbt_backup" cascade
[0m08:33:21.151154 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m08:33:21.152286 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.closure_rate_by_group (execute): 08:33:21.117962 => 08:33:21.152132
[0m08:33:21.152633 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: Close
[0m08:33:21.153369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9d409ca-7d8a-478a-837d-a58ee5a219e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7bd9f90>]}
[0m08:33:21.153948 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.closure_rate_by_group ................. [[32mSELECT 181[0m in 0.04s]
[0m08:33:21.154617 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.closure_rate_by_group
[0m08:33:21.155041 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.monthly_ticket_summary
[0m08:33:21.155483 [info ] [Thread-1 (]: 4 of 4 START sql table model public.monthly_ticket_summary ..................... [RUN]
[0m08:33:21.156123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.itsm_dbt_project.closure_rate_by_group, now model.itsm_dbt_project.monthly_ticket_summary)
[0m08:33:21.156459 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.monthly_ticket_summary
[0m08:33:21.159032 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.monthly_ticket_summary"
[0m08:33:21.159906 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.monthly_ticket_summary (compile): 08:33:21.156694 => 08:33:21.159716
[0m08:33:21.160457 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.monthly_ticket_summary
[0m08:33:21.165014 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.monthly_ticket_summary"
[0m08:33:21.165775 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.monthly_ticket_summary"
[0m08:33:21.166103 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: BEGIN
[0m08:33:21.166406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:33:21.173120 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m08:33:21.173489 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.monthly_ticket_summary"
[0m08:33:21.173877 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.monthly_ticket_summary"} */

  
    

  create  table "itsm_db"."public"."monthly_ticket_summary__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    EXTRACT(YEAR FROM created_date) AS created_year,
    EXTRACT(MONTH FROM created_date) AS created_month,
    COUNT(ticket_id) AS total_tickets,
    SUM(CASE WHEN is_closed = 1 THEN 1 ELSE 0 END) AS closed_tickets
FROM "itsm_db"."public"."tickets_analysis"
GROUP BY EXTRACT(YEAR FROM created_date), EXTRACT(MONTH FROM created_date)
ORDER BY EXTRACT(YEAR FROM created_date), EXTRACT(MONTH FROM created_date)
  );
  
[0m08:33:21.179031 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m08:33:21.181891 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.monthly_ticket_summary"
[0m08:33:21.182293 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.monthly_ticket_summary"} */
alter table "itsm_db"."public"."monthly_ticket_summary" rename to "monthly_ticket_summary__dbt_backup"
[0m08:33:21.182861 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:33:21.185375 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.monthly_ticket_summary"
[0m08:33:21.185741 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.monthly_ticket_summary"} */
alter table "itsm_db"."public"."monthly_ticket_summary__dbt_tmp" rename to "monthly_ticket_summary"
[0m08:33:21.186289 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:33:21.188031 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: COMMIT
[0m08:33:21.188411 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.monthly_ticket_summary"
[0m08:33:21.188822 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: COMMIT
[0m08:33:21.189641 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:33:21.191836 [debug] [Thread-1 (]: Applying DROP to: "itsm_db"."public"."monthly_ticket_summary__dbt_backup"
[0m08:33:21.192543 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.monthly_ticket_summary"
[0m08:33:21.192908 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.monthly_ticket_summary"} */
drop table if exists "itsm_db"."public"."monthly_ticket_summary__dbt_backup" cascade
[0m08:33:21.194963 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m08:33:21.196106 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.monthly_ticket_summary (execute): 08:33:21.160734 => 08:33:21.195948
[0m08:33:21.196446 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: Close
[0m08:33:21.197203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9d409ca-7d8a-478a-837d-a58ee5a219e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7c4c2b0>]}
[0m08:33:21.197746 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.monthly_ticket_summary ................ [[32mSELECT 1[0m in 0.04s]
[0m08:33:21.198345 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.monthly_ticket_summary
[0m08:33:21.199740 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:21.200046 [debug] [MainThread]: On master: BEGIN
[0m08:33:21.200310 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:33:21.207035 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:33:21.207362 [debug] [MainThread]: On master: COMMIT
[0m08:33:21.207685 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:21.207996 [debug] [MainThread]: On master: COMMIT
[0m08:33:21.208328 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:33:21.208603 [debug] [MainThread]: On master: Close
[0m08:33:21.209296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:33:21.209638 [debug] [MainThread]: Connection 'list_itsm_db' was properly closed.
[0m08:33:21.209931 [debug] [MainThread]: Connection 'model.itsm_dbt_project.monthly_ticket_summary' was properly closed.
[0m08:33:21.210592 [info ] [MainThread]: 
[0m08:33:21.211082 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m08:33:21.212121 [debug] [MainThread]: Command end result
[0m08:33:21.219552 [info ] [MainThread]: 
[0m08:33:21.219931 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:33:21.220317 [info ] [MainThread]: 
[0m08:33:21.220685 [error] [MainThread]:   Database Error in model avg_resolution_by_cat_priority (models/avg_resolution_by_cat_priority.sql)
  syntax error at or near ";"
  LINE 28: ORDER BY category, priority;
                                      ^
  compiled Code at target/run/itsm_dbt_project/models/avg_resolution_by_cat_priority.sql
[0m08:33:21.221070 [info ] [MainThread]: 
[0m08:33:21.221530 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m08:33:21.222778 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8986004, "process_user_time": 2.318915, "process_kernel_time": 0.144869, "process_mem_max_rss": "139080", "process_out_blocks": "2355", "command_success": false, "process_in_blocks": "0"}
[0m08:33:21.223276 [debug] [MainThread]: Command `dbt run` failed at 08:33:21.223183 after 0.90 seconds
[0m08:33:21.223621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd1b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7d2b880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7d2bca0>]}
[0m08:33:21.223965 [debug] [MainThread]: Flushing usage events
[0m08:35:17.359685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd1b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41e70>]}


============================== 08:35:17.373213 | 97718c9a-71ef-443a-bd19-1ace4f51506b ==============================
[0m08:35:17.373213 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:35:17.374076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:35:17.505220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97718c9a-71ef-443a-bd19-1ace4f51506b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffaa41fc0>]}
[0m08:35:17.569737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97718c9a-71ef-443a-bd19-1ace4f51506b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8fc6230>]}
[0m08:35:17.570386 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:35:17.579978 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m08:35:17.606775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:35:17.607353 [debug] [MainThread]: Partial parsing: updated file: itsm_dbt_project://models/avg_resolution_by_cat_priority.sql
[0m08:35:17.741759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97718c9a-71ef-443a-bd19-1ace4f51506b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7ced930>]}
[0m08:35:17.756852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97718c9a-71ef-443a-bd19-1ace4f51506b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8ea2bc0>]}
[0m08:35:17.757356 [info ] [MainThread]: Found 4 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:35:17.757758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97718c9a-71ef-443a-bd19-1ace4f51506b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8ea2ad0>]}
[0m08:35:17.759196 [info ] [MainThread]: 
[0m08:35:17.760074 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:35:17.762835 [debug] [ThreadPool]: Acquiring new postgres connection 'list_itsm_db'
[0m08:35:17.771713 [debug] [ThreadPool]: Using postgres connection "list_itsm_db"
[0m08:35:17.772075 [debug] [ThreadPool]: On list_itsm_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "list_itsm_db"} */

    select distinct nspname from pg_namespace
  
[0m08:35:17.772373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:35:17.821254 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m08:35:17.822886 [debug] [ThreadPool]: On list_itsm_db: Close
[0m08:35:17.825282 [debug] [ThreadPool]: Acquiring new postgres connection 'list_itsm_db_public'
[0m08:35:17.830066 [debug] [ThreadPool]: Using postgres connection "list_itsm_db_public"
[0m08:35:17.830439 [debug] [ThreadPool]: On list_itsm_db_public: BEGIN
[0m08:35:17.830778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:35:17.838465 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:35:17.838847 [debug] [ThreadPool]: Using postgres connection "list_itsm_db_public"
[0m08:35:17.839220 [debug] [ThreadPool]: On list_itsm_db_public: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "list_itsm_db_public"} */
select
      'itsm_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'itsm_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'itsm_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:35:17.842154 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m08:35:17.843421 [debug] [ThreadPool]: On list_itsm_db_public: ROLLBACK
[0m08:35:17.843878 [debug] [ThreadPool]: On list_itsm_db_public: Close
[0m08:35:17.848732 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:17.849099 [debug] [MainThread]: On master: BEGIN
[0m08:35:17.849396 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:35:17.856720 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:35:17.857061 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:17.857469 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:35:17.861561 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m08:35:17.862494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97718c9a-71ef-443a-bd19-1ace4f51506b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7ce6ce0>]}
[0m08:35:17.862913 [debug] [MainThread]: On master: ROLLBACK
[0m08:35:17.863327 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:17.863624 [debug] [MainThread]: On master: BEGIN
[0m08:35:17.864087 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:35:17.864389 [debug] [MainThread]: On master: COMMIT
[0m08:35:17.864685 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:17.864975 [debug] [MainThread]: On master: COMMIT
[0m08:35:17.865384 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:35:17.865676 [debug] [MainThread]: On master: Close
[0m08:35:17.866382 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:35:17.866778 [info ] [MainThread]: 
[0m08:35:17.869801 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.tickets_analysis
[0m08:35:17.870370 [info ] [Thread-1 (]: 1 of 4 START sql table model public.tickets_analysis ........................... [RUN]
[0m08:35:17.871227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_itsm_db_public, now model.itsm_dbt_project.tickets_analysis)
[0m08:35:17.871621 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.tickets_analysis
[0m08:35:17.878880 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.tickets_analysis"
[0m08:35:17.880246 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.tickets_analysis (compile): 08:35:17.871872 => 08:35:17.880045
[0m08:35:17.880624 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.tickets_analysis
[0m08:35:17.912886 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.tickets_analysis"
[0m08:35:17.915843 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m08:35:17.916287 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: BEGIN
[0m08:35:17.916618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:35:17.922922 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m08:35:17.923357 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m08:35:17.923774 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */

  
    

  create  table "itsm_db"."public"."tickets_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH cleaned AS (
    SELECT DISTINCT
        inc_number AS ticket_id,
        inc_category AS category,
        inc_short_description AS sub_category,
        inc_priority AS priority,
        inc_state AS status,
        inc_assignment_group AS assigned_group,
        inc_assigned_to AS technician,
        NULL::float AS resolution_time_hrs,
        inc_sys_created_on::timestamp AS created_date,
        inc_resolved_at::timestamp AS resolved_date,
        NULL::text AS customer_impact
    FROM "itsm_db"."public"."tickets_raw"
    WHERE inc_number IS NOT NULL
)
SELECT
    *,
    EXTRACT(YEAR FROM created_date) AS created_year,
    EXTRACT(MONTH FROM created_date) AS created_month,
    EXTRACT(DAY FROM created_date) AS created_day,
    CASE WHEN status ILIKE 'closed' OR resolved_date IS NOT NULL THEN 1 ELSE 0 END AS is_closed
FROM cleaned
  );
  
[0m08:35:17.947919 [debug] [Thread-1 (]: SQL status: SELECT 4918 in 0.0 seconds
[0m08:35:17.953248 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m08:35:17.953648 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */
alter table "itsm_db"."public"."tickets_analysis" rename to "tickets_analysis__dbt_backup"
[0m08:35:17.954267 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:35:17.956758 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m08:35:17.957117 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */
alter table "itsm_db"."public"."tickets_analysis__dbt_tmp" rename to "tickets_analysis"
[0m08:35:17.958127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:35:17.973468 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: COMMIT
[0m08:35:17.973871 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m08:35:17.974355 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: COMMIT
[0m08:35:17.978082 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:35:17.983119 [debug] [Thread-1 (]: Applying DROP to: "itsm_db"."public"."tickets_analysis__dbt_backup"
[0m08:35:17.986757 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.tickets_analysis"
[0m08:35:17.987143 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.tickets_analysis"} */
drop table if exists "itsm_db"."public"."tickets_analysis__dbt_backup" cascade
[0m08:35:17.990180 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m08:35:17.991376 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.tickets_analysis (execute): 08:35:17.880890 => 08:35:17.991209
[0m08:35:17.991713 [debug] [Thread-1 (]: On model.itsm_dbt_project.tickets_analysis: Close
[0m08:35:17.992429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97718c9a-71ef-443a-bd19-1ace4f51506b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff910e620>]}
[0m08:35:17.993396 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.tickets_analysis ...................... [[32mSELECT 4918[0m in 0.12s]
[0m08:35:17.994033 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.tickets_analysis
[0m08:35:17.995570 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m08:35:17.996155 [info ] [Thread-1 (]: 2 of 4 START sql table model public.avg_resolution_by_cat_priority ............. [RUN]
[0m08:35:17.996894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.itsm_dbt_project.tickets_analysis, now model.itsm_dbt_project.avg_resolution_by_cat_priority)
[0m08:35:17.997282 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m08:35:17.999847 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m08:35:18.001140 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.avg_resolution_by_cat_priority (compile): 08:35:17.997545 => 08:35:18.000914
[0m08:35:18.001543 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m08:35:18.031022 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m08:35:18.032267 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m08:35:18.032649 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: BEGIN
[0m08:35:18.032969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:35:18.039873 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m08:35:18.040325 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m08:35:18.040719 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.avg_resolution_by_cat_priority"} */

  
    

  create  table "itsm_db"."public"."avg_resolution_by_cat_priority__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    category,
    priority,
    ROUND(
        AVG(
            COALESCE(
                resolution_time_hrs,
                EXTRACT(EPOCH FROM (resolved_date - created_date))/3600
            )
        )::numeric,
        2
    ) AS avg_resolution_hours
FROM "itsm_db"."public"."tickets_analysis"
GROUP BY category, priority
  );
  
[0m08:35:18.047795 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0.0 seconds
[0m08:35:18.050521 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m08:35:18.050948 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.avg_resolution_by_cat_priority"} */
alter table "itsm_db"."public"."avg_resolution_by_cat_priority" rename to "avg_resolution_by_cat_priority__dbt_backup"
[0m08:35:18.051502 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:35:18.053930 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m08:35:18.054302 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.avg_resolution_by_cat_priority"} */
alter table "itsm_db"."public"."avg_resolution_by_cat_priority__dbt_tmp" rename to "avg_resolution_by_cat_priority"
[0m08:35:18.054979 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:35:18.056756 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: COMMIT
[0m08:35:18.057119 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m08:35:18.057450 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: COMMIT
[0m08:35:18.058115 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:35:18.060142 [debug] [Thread-1 (]: Applying DROP to: "itsm_db"."public"."avg_resolution_by_cat_priority__dbt_backup"
[0m08:35:18.060832 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.avg_resolution_by_cat_priority"
[0m08:35:18.061163 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.avg_resolution_by_cat_priority"} */
drop table if exists "itsm_db"."public"."avg_resolution_by_cat_priority__dbt_backup" cascade
[0m08:35:18.062885 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m08:35:18.064061 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.avg_resolution_by_cat_priority (execute): 08:35:18.001813 => 08:35:18.063884
[0m08:35:18.064409 [debug] [Thread-1 (]: On model.itsm_dbt_project.avg_resolution_by_cat_priority: Close
[0m08:35:18.065171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97718c9a-71ef-443a-bd19-1ace4f51506b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7bd9ff0>]}
[0m08:35:18.065739 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.avg_resolution_by_cat_priority ........ [[32mSELECT 20[0m in 0.07s]
[0m08:35:18.066486 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.avg_resolution_by_cat_priority
[0m08:35:18.066897 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.closure_rate_by_group
[0m08:35:18.067355 [info ] [Thread-1 (]: 3 of 4 START sql table model public.closure_rate_by_group ...................... [RUN]
[0m08:35:18.068008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.itsm_dbt_project.avg_resolution_by_cat_priority, now model.itsm_dbt_project.closure_rate_by_group)
[0m08:35:18.068381 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.closure_rate_by_group
[0m08:35:18.070841 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.closure_rate_by_group"
[0m08:35:18.071678 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.closure_rate_by_group (compile): 08:35:18.068605 => 08:35:18.071498
[0m08:35:18.072021 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.closure_rate_by_group
[0m08:35:18.075411 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.closure_rate_by_group"
[0m08:35:18.076136 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m08:35:18.076528 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: BEGIN
[0m08:35:18.076875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:35:18.083791 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m08:35:18.084186 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m08:35:18.084577 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.closure_rate_by_group"} */

  
    

  create  table "itsm_db"."public"."closure_rate_by_group__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    assigned_group,
    COUNT(*) AS total_tickets,
    SUM(CASE WHEN is_closed = 1 THEN 1 ELSE 0 END)::float / COUNT(*) * 100 AS closure_rate_percent
FROM "itsm_db"."public"."tickets_analysis"
GROUP BY assigned_group
ORDER BY closure_rate_percent DESC
  );
  
[0m08:35:18.090366 [debug] [Thread-1 (]: SQL status: SELECT 181 in 0.0 seconds
[0m08:35:18.093072 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m08:35:18.093464 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.closure_rate_by_group"} */
alter table "itsm_db"."public"."closure_rate_by_group" rename to "closure_rate_by_group__dbt_backup"
[0m08:35:18.094100 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:35:18.097390 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m08:35:18.097829 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.closure_rate_by_group"} */
alter table "itsm_db"."public"."closure_rate_by_group__dbt_tmp" rename to "closure_rate_by_group"
[0m08:35:18.098595 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:35:18.100271 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: COMMIT
[0m08:35:18.100620 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m08:35:18.100963 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: COMMIT
[0m08:35:18.101636 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:35:18.103791 [debug] [Thread-1 (]: Applying DROP to: "itsm_db"."public"."closure_rate_by_group__dbt_backup"
[0m08:35:18.104528 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.closure_rate_by_group"
[0m08:35:18.104879 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.closure_rate_by_group"} */
drop table if exists "itsm_db"."public"."closure_rate_by_group__dbt_backup" cascade
[0m08:35:18.106687 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m08:35:18.107801 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.closure_rate_by_group (execute): 08:35:18.072238 => 08:35:18.107651
[0m08:35:18.108121 [debug] [Thread-1 (]: On model.itsm_dbt_project.closure_rate_by_group: Close
[0m08:35:18.108836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97718c9a-71ef-443a-bd19-1ace4f51506b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7d21450>]}
[0m08:35:18.109398 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.closure_rate_by_group ................. [[32mSELECT 181[0m in 0.04s]
[0m08:35:18.110669 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.closure_rate_by_group
[0m08:35:18.111143 [debug] [Thread-1 (]: Began running node model.itsm_dbt_project.monthly_ticket_summary
[0m08:35:18.111658 [info ] [Thread-1 (]: 4 of 4 START sql table model public.monthly_ticket_summary ..................... [RUN]
[0m08:35:18.112328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.itsm_dbt_project.closure_rate_by_group, now model.itsm_dbt_project.monthly_ticket_summary)
[0m08:35:18.112683 [debug] [Thread-1 (]: Began compiling node model.itsm_dbt_project.monthly_ticket_summary
[0m08:35:18.115273 [debug] [Thread-1 (]: Writing injected SQL for node "model.itsm_dbt_project.monthly_ticket_summary"
[0m08:35:18.116138 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.monthly_ticket_summary (compile): 08:35:18.112925 => 08:35:18.115944
[0m08:35:18.116482 [debug] [Thread-1 (]: Began executing node model.itsm_dbt_project.monthly_ticket_summary
[0m08:35:18.119954 [debug] [Thread-1 (]: Writing runtime sql for node "model.itsm_dbt_project.monthly_ticket_summary"
[0m08:35:18.120747 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.monthly_ticket_summary"
[0m08:35:18.121097 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: BEGIN
[0m08:35:18.121434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:35:18.127979 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m08:35:18.128534 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.monthly_ticket_summary"
[0m08:35:18.128986 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.monthly_ticket_summary"} */

  
    

  create  table "itsm_db"."public"."monthly_ticket_summary__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    EXTRACT(YEAR FROM created_date) AS created_year,
    EXTRACT(MONTH FROM created_date) AS created_month,
    COUNT(ticket_id) AS total_tickets,
    SUM(CASE WHEN is_closed = 1 THEN 1 ELSE 0 END) AS closed_tickets
FROM "itsm_db"."public"."tickets_analysis"
GROUP BY EXTRACT(YEAR FROM created_date), EXTRACT(MONTH FROM created_date)
ORDER BY EXTRACT(YEAR FROM created_date), EXTRACT(MONTH FROM created_date)
  );
  
[0m08:35:18.134396 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m08:35:18.137131 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.monthly_ticket_summary"
[0m08:35:18.137535 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.monthly_ticket_summary"} */
alter table "itsm_db"."public"."monthly_ticket_summary" rename to "monthly_ticket_summary__dbt_backup"
[0m08:35:18.138075 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:35:18.140588 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.monthly_ticket_summary"
[0m08:35:18.140941 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.monthly_ticket_summary"} */
alter table "itsm_db"."public"."monthly_ticket_summary__dbt_tmp" rename to "monthly_ticket_summary"
[0m08:35:18.141534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:35:18.143335 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: COMMIT
[0m08:35:18.143721 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.monthly_ticket_summary"
[0m08:35:18.144168 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: COMMIT
[0m08:35:18.144859 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m08:35:18.147135 [debug] [Thread-1 (]: Applying DROP to: "itsm_db"."public"."monthly_ticket_summary__dbt_backup"
[0m08:35:18.147848 [debug] [Thread-1 (]: Using postgres connection "model.itsm_dbt_project.monthly_ticket_summary"
[0m08:35:18.148199 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "itsm_dbt_project", "target_name": "dev", "node_id": "model.itsm_dbt_project.monthly_ticket_summary"} */
drop table if exists "itsm_db"."public"."monthly_ticket_summary__dbt_backup" cascade
[0m08:35:18.149941 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m08:35:18.151188 [debug] [Thread-1 (]: Timing info for model.itsm_dbt_project.monthly_ticket_summary (execute): 08:35:18.116702 => 08:35:18.151014
[0m08:35:18.151549 [debug] [Thread-1 (]: On model.itsm_dbt_project.monthly_ticket_summary: Close
[0m08:35:18.152332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97718c9a-71ef-443a-bd19-1ace4f51506b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7bd5750>]}
[0m08:35:18.152982 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.monthly_ticket_summary ................ [[32mSELECT 1[0m in 0.04s]
[0m08:35:18.153561 [debug] [Thread-1 (]: Finished running node model.itsm_dbt_project.monthly_ticket_summary
[0m08:35:18.154789 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:18.155100 [debug] [MainThread]: On master: BEGIN
[0m08:35:18.155367 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:35:18.161846 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:35:18.162265 [debug] [MainThread]: On master: COMMIT
[0m08:35:18.162594 [debug] [MainThread]: Using postgres connection "master"
[0m08:35:18.162908 [debug] [MainThread]: On master: COMMIT
[0m08:35:18.163355 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:35:18.163673 [debug] [MainThread]: On master: Close
[0m08:35:18.164324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:35:18.164708 [debug] [MainThread]: Connection 'list_itsm_db' was properly closed.
[0m08:35:18.165019 [debug] [MainThread]: Connection 'model.itsm_dbt_project.monthly_ticket_summary' was properly closed.
[0m08:35:18.165582 [info ] [MainThread]: 
[0m08:35:18.165965 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m08:35:18.166969 [debug] [MainThread]: Command end result
[0m08:35:18.174515 [info ] [MainThread]: 
[0m08:35:18.174896 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:35:18.175268 [info ] [MainThread]: 
[0m08:35:18.175757 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:35:18.177064 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8658371, "process_user_time": 2.254241, "process_kernel_time": 0.158438, "process_mem_max_rss": "138636", "process_out_blocks": "2358", "process_in_blocks": "0"}
[0m08:35:18.177602 [debug] [MainThread]: Command `dbt run` succeeded at 08:35:18.177501 after 0.87 seconds
[0m08:35:18.178052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffcd1b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7d69b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff7d6af20>]}
[0m08:35:18.178418 [debug] [MainThread]: Flushing usage events
